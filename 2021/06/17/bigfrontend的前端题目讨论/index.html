<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/Frog_32px_1177822_easyicon.net.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Frog_32px_1177822_easyicon.net.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/Frog_16px_1177822_easyicon.net.ico">
  <link rel="mask-icon" href="/images/Frog_32px_1177822_easyicon.net.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hxy1997.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":true,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"输入关键字","hits_empty":"没有找到与「${query}」相关搜索","hits_stats":"${hits} 条相关记录，共耗时 ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="国外前端会考察哪些问题？js函数、系统设计、TS类型体操的用法，大大拓宽了我的眼界，去思考和实战更加相关的问题吧">
<meta property="og:type" content="article">
<meta property="og:title" content="bigfrontend的前端题目讨论">
<meta property="og:url" content="https://hxy1997.xyz/2021/06/17/bigfrontend%E7%9A%84%E5%89%8D%E7%AB%AF%E9%A2%98%E7%9B%AE%E8%AE%A8%E8%AE%BA/index.html">
<meta property="og:site_name" content="hxy的博客">
<meta property="og:description" content="国外前端会考察哪些问题？js函数、系统设计、TS类型体操的用法，大大拓宽了我的眼界，去思考和实战更加相关的问题吧">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-06-17T13:07:33.000Z">
<meta property="article:modified_time" content="2021-10-05T03:49:40.972Z">
<meta property="article:author" content="hxy">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="bigfrontend">
<meta property="article:tag" content="题库">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hxy1997.xyz/2021/06/17/bigfrontend%E7%9A%84%E5%89%8D%E7%AB%AF%E9%A2%98%E7%9B%AE%E8%AE%A8%E8%AE%BA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>bigfrontend的前端题目讨论 | hxy的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="hxy的博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">hxy的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Mia san Mia!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/huxingyi1997" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hxy1997.xyz/2021/06/17/bigfrontend%E7%9A%84%E5%89%8D%E7%AB%AF%E9%A2%98%E7%9B%AE%E8%AE%A8%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Robben.gif">
      <meta itemprop="name" content="hxy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxy的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          bigfrontend的前端题目讨论
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-17 21:07:33" itemprop="dateCreated datePublished" datetime="2021-06-17T21:07:33+08:00">2021-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-05 11:49:40" itemprop="dateModified" datetime="2021-10-05T11:49:40+08:00">2021-10-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">web前端</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="热度" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">热度：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/06/17/bigfrontend%E7%9A%84%E5%89%8D%E7%AB%AF%E9%A2%98%E7%9B%AE%E8%AE%A8%E8%AE%BA/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/17/bigfrontend%E7%9A%84%E5%89%8D%E7%AB%AF%E9%A2%98%E7%9B%AE%E8%AE%A8%E8%AE%BA/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>国外前端会考察哪些问题？js函数、系统设计、TS类型体操的用法，大大拓宽了我的眼界，去思考和实战更加相关的问题吧</p>
<span id="more"></span>

<h2 id="js函数"><a href="#js函数" class="headerlink" title="js函数"></a>js函数</h2><h3 id="1-implement-curry"><a href="#1-implement-curry" class="headerlink" title="1. implement curry()"></a>1. implement curry()</h3><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Currying">Currying</a> is a useful technique used in JavaScript applications.</p>
<p>Please implement a <code>curry()</code> function, which accepts a function and return a curried one.</p>
<p>Here is an example</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> join = <span class="function">(<span class="params">a, b, c</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;a&#125;</span>_<span class="subst">$&#123;b&#125;</span>_<span class="subst">$&#123;c&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> curriedJoin = curry(join)</span><br><span class="line"></span><br><span class="line">curriedJoin(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// &#x27;1_2_3&#x27;</span></span><br><span class="line"></span><br><span class="line">curriedJoin(<span class="number">1</span>)(<span class="number">2</span>, <span class="number">3</span>) <span class="comment">// &#x27;1_2_3&#x27;</span></span><br><span class="line"></span><br><span class="line">curriedJoin(<span class="number">1</span>, <span class="number">2</span>)(<span class="number">3</span>) <span class="comment">// &#x27;1_2_3&#x27;</span></span><br></pre></td></tr></table></figure>

<p>more to read</p>
<p><a target="_blank" rel="noopener" href="https://javascript.info/currying-partials">https://javascript.info/currying-partials</a></p>
<p><a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#curry">https://lodash.com/docs/4.17.15#curry</a></p>
<p>使用闭包返回执行的结果，函数柯里化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; (...args: any[]) =&gt; any &#125;</span> <span class="variable">fn</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123; (...args: any[]) =&gt; any &#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">curryInner</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (args.length &gt;= fn.length) <span class="keyword">return</span> fn(...args);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">...newArgs</span>) =&gt;</span> curryInner(...args, ...newArgs);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> join = <span class="function">(<span class="params">a, b, c</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;a&#125;</span>_<span class="subst">$&#123;b&#125;</span>_<span class="subst">$&#123;c&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> curriedJoin = curry(join);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(curriedJoin(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// &#x27;1_2_3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(curriedJoin(<span class="number">1</span>)(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// &#x27;1_2_3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(curriedJoin(<span class="number">1</span>, <span class="number">2</span>)(<span class="number">3</span>)); <span class="comment">// &#x27;1_2_3&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-implement-curry-with-placeholder-support"><a href="#2-implement-curry-with-placeholder-support" class="headerlink" title="2. implement curry() with placeholder support"></a>2. implement curry() with placeholder support</h3><p>This is a follow-up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-curry">1. implement curry()</a></p>
<p>please implement <code>curry()</code> which also supports placeholder.</p>
<p>Here is an example</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span>  join = <span class="function">(<span class="params">a, b, c</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;a&#125;</span>_<span class="subst">$&#123;b&#125;</span>_<span class="subst">$&#123;c&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> curriedJoin = curry(join)</span><br><span class="line"><span class="keyword">const</span> _ = curry.placeholder</span><br><span class="line"></span><br><span class="line">curriedJoin(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// &#x27;1_2_3&#x27;</span></span><br><span class="line"></span><br><span class="line">curriedJoin(_, <span class="number">2</span>)(<span class="number">1</span>, <span class="number">3</span>) <span class="comment">// &#x27;1_2_3&#x27;</span></span><br><span class="line"></span><br><span class="line">curriedJoin(_, _, _)(<span class="number">1</span>)(_, <span class="number">3</span>)(<span class="number">2</span>) <span class="comment">// &#x27;1_2_3&#x27;</span></span><br></pre></td></tr></table></figure>

<p>more to read</p>
<p><a target="_blank" rel="noopener" href="https://javascript.info/currying-partials">https://javascript.info/currying-partials</a></p>
<p><a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#curry">https://lodash.com/docs/4.17.15#curry</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/planttheidea/curriable">https://github.com/planttheidea/curriable</a></p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-curry">1. implement curry()</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; (...args: any[]) =&gt; any &#125;</span> <span class="variable">fn</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123; (...args: any[]) =&gt; any &#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">curryInner</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (args.length &gt;= fn.length &amp;&amp; !args.includes(curry.placeholder)) <span class="keyword">return</span> fn(...args);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">...newArgs</span>) =&gt;</span> curryInner(...args.map(<span class="function"><span class="params">item</span> =&gt;</span> item === curry.placeholder ? newArgs.shift() : item), ...newArgs);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curry.placeholder = <span class="built_in">Symbol</span>()</span><br></pre></td></tr></table></figure>

<h3 id="3-implement-Array-prototype-flat"><a href="#3-implement-Array-prototype-flat" class="headerlink" title="3. implement Array.prototype.flat()"></a>3. implement Array.prototype.flat()</h3><p>There is already <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat">Array.prototype.flat()</a> in JavaScript (ES2019), which reduces the nesting of Array.</p>
<p>Could you manage to implement your own one?</p>
<p>Here is an example to illustrate</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, [<span class="number">2</span>], [<span class="number">3</span>, [<span class="number">4</span>]]];</span><br><span class="line"></span><br><span class="line">flat(arr)</span><br><span class="line"><span class="comment">// [1, 2, 3, [4]]</span></span><br><span class="line"></span><br><span class="line">flat(arr, <span class="number">1</span>)</span><br><span class="line"><span class="comment">// [1, 2, 3, [4]]</span></span><br><span class="line"></span><br><span class="line">flat(arr, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<p><strong>follow up</strong></p>
<p>Are you able to solve it both recursively and iteratively?</p>
<p>直接递归展开</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; Array &#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; number &#125;</span> <span class="variable">depth</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123; Array &#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flat</span>(<span class="params">arr, depth = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> flatArray = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(item) &amp;&amp; depth &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      flatArray = flatArray.concat(flat(item, depth - <span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      flatArray.push(item);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> flatArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>改用reduce递归</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; Array &#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; number &#125;</span> <span class="variable">depth</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123; Array &#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flat</span>(<span class="params">arr, depth = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your imeplementation here</span></span><br><span class="line">  <span class="keyword">return</span> arr.reduce(</span><br><span class="line">    (acc, item) =&gt; </span><br><span class="line">      <span class="built_in">Array</span>.isArray(item) &amp;&amp; depth &gt; <span class="number">0</span></span><br><span class="line">        ? acc.concat(flat(item, depth - <span class="number">1</span>))</span><br><span class="line">        : [...acc, item],</span><br><span class="line">    []</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-implement-basic-throttle"><a href="#4-implement-basic-throttle" class="headerlink" title="4. implement basic throttle()"></a>4. implement basic throttle()</h3><p>Throttling is a common technique used in Web Application, in most cases using <a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#throttle">lodash solution</a> would be a good choice.</p>
<p>could you implement your own version of basic <code>throttle()</code>?</p>
<p>In case you forgot, <code>throttle(func, delay)</code> will return a throttled function, which will invoke the func at a max frequency no matter how throttled one is called.</p>
<p>Here is an example.</p>
<p>Before throttling we have a series of calling like</p>
<p>─A─B─C─ ─D─ ─ ─ ─ ─ ─ E─ ─F─G</p>
<p>After throttling at wait time of 3 dashes</p>
<p>─A─ ─ ─C─ ─ ─D ─ ─ ─ ─ E─ ─ ─G</p>
<p>Be aware that</p>
<ul>
<li>call A is triggered right way because not in waiting time</li>
<li>function call B is swallowed because B, C is in the cooling time from A, and C is latter.</li>
</ul>
<p><strong>notes</strong></p>
<ol>
<li>please follow above spec. the behavior is not exactly the same as <code>lodash.throttle()</code></li>
<li>because <code>window.setTimeout</code> and <code>window.clearTimeout</code> are not accurate in browser environment, they are replaced to other implementation when judging your code. They still have the same interface, and internally keep track of the timing for testing purpose.</li>
</ol>
<p>Something like below will be used to do the test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> currentTime = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> run = <span class="function">(<span class="params">input</span>) =&gt;</span> &#123;</span><br><span class="line">  currentTime = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> calls = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> func = <span class="function">(<span class="params">arg</span>) =&gt;</span> &#123;</span><br><span class="line">     calls.push(<span class="string">`<span class="subst">$&#123;arg&#125;</span>@<span class="subst">$&#123;currentTime&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> throttled = throttle(func, <span class="number">3</span>)</span><br><span class="line">  input.forEach(<span class="function">(<span class="params">call</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> [arg, time] = call.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> throttled(arg), time)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> calls</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">expect(run([<span class="string">&#x27;A@0&#x27;</span>, <span class="string">&#x27;B@2&#x27;</span>, <span class="string">&#x27;C@3&#x27;</span>])).toEqual([<span class="string">&#x27;A@0&#x27;</span>, <span class="string">&#x27;C@3&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-throttle-with-leading-and-trailing-option">5. implement throttle() with leading &amp; trailing option</a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-debounce">6. implement basic debounce()</a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-debounce-with-leading-and-trailing-option">7. implement debounce() with leading &amp; trailing option</a></p>
<p>利用标志位isWaiting保存状态，判断是否在等待，lastCallArgs保存上一次的参数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">wait</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Track if we are waiting. Initially, we are not.</span></span><br><span class="line">  <span class="keyword">let</span> isWaiting = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// Track arguments of last call</span></span><br><span class="line">  <span class="keyword">let</span> lastCallArgs = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">throttled</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// If we are waiting,</span></span><br><span class="line">    <span class="keyword">if</span> (isWaiting) &#123;</span><br><span class="line">      <span class="comment">// ...store arguments of last call</span></span><br><span class="line">      lastCallArgs = args;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// If we are not waiting, execute &#x27;func&#x27; with passed arguments</span></span><br><span class="line">    func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    <span class="comment">// Prevent future execution of &#x27;func&#x27;</span></span><br><span class="line">    isWaiting = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// After wait time,</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// ...allow execution of &#x27;func&#x27;</span></span><br><span class="line">      isWaiting = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// If arguments of last call exists,</span></span><br><span class="line">      <span class="keyword">if</span> (lastCallArgs) &#123;</span><br><span class="line">        <span class="comment">// ...execute function throttled and pass last call&#x27;s arguments</span></span><br><span class="line">        <span class="comment">// to it. Since now we are not waiting, &#x27;func&#x27; will be executed</span></span><br><span class="line">        <span class="comment">// and isWaiting will be reset to true.</span></span><br><span class="line">        throttled.apply(<span class="built_in">this</span>, lastCallArgs);</span><br><span class="line">        <span class="comment">// ...reset arguments of last call to null.</span></span><br><span class="line">        lastCallArgs = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-implement-throttle-with-leading-amp-trailing-option"><a href="#5-implement-throttle-with-leading-amp-trailing-option" class="headerlink" title="5. implement throttle() with leading &amp; trailing option"></a>5. implement throttle() with leading &amp; trailing option</h3><p>This is a follow up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-throttle">4. implement basic throttle()</a>, please refer to it for detailed explanation.</p>
<p>In this problem, you are asked to implement a enhanced <code>throttle()</code> which accepts third parameter, <code>option: &#123;leading: boolean, trailing: boolean&#125;</code></p>
<ol>
<li>leading: whether to invoke right away</li>
<li>trailing: whether to invoke after the delay.</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-throttle()">4. implement basic throttle()</a> is the default case with <code>&#123;leading: true, trailing: true&#125;</code>.</p>
<p><strong>Explanation</strong></p>
<p>for the previous example of throttling by 3 dashes</p>
<p>─A─B─C─ ─D─ ─ ─ ─ ─ ─ E─ ─F─G</p>
<p>with <code>&#123;leading: true, trailing: true&#125;</code>, we get as below</p>
<p>─A─ ─ ─C─ ─ ─D ─ ─ ─ ─ E─ ─ ─G</p>
<p>with <code>&#123;leading: false, trailing: true&#125;</code>, A and E are swallowed.</p>
<p>─ ─ ─ ─C─ ─ ─D─ ─ ─ ─ ─ ─ ─G</p>
<p>with<code> &#123;leading: true, trailing: false&#125;</code>, only A D E are kept</p>
<p>─A─ ─ ─ ─D─ ─ ─ ─ ─ ─ E</p>
<p>with <code>&#123;leading: false, trailing: false&#125;</code>, of course, nothing happens.</p>
<p><strong>notes</strong></p>
<ol>
<li>please follow above spec. the behavior is not exactly the same as <code>lodash.throttle()</code></li>
<li>because <code>window.setTimeout</code> and <code>window.clearTimeout</code> are not accurate in browser environment, they are replaced to other implementation when judging your code. They still have the same interface, and internally keep track of the timing for testing purpose.</li>
</ol>
<p>Something like below will be used to do the test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> currentTime = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> run = <span class="function">(<span class="params">input</span>) =&gt;</span> &#123;</span><br><span class="line">  currentTime = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> calls = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> func = <span class="function">(<span class="params">arg</span>) =&gt;</span> &#123;</span><br><span class="line">     calls.push(<span class="string">`<span class="subst">$&#123;arg&#125;</span>@<span class="subst">$&#123;currentTime&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> throttled = throttle(func, <span class="number">3</span>)</span><br><span class="line">  input.forEach(<span class="function">(<span class="params">call</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> [arg, time] = call.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> throttled(arg), time)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> calls</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">expect(run([<span class="string">&#x27;A@0&#x27;</span>, <span class="string">&#x27;B@2&#x27;</span>, <span class="string">&#x27;C@3&#x27;</span>])).toEqual([<span class="string">&#x27;A@0&#x27;</span>, <span class="string">&#x27;C@3&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-throttle">4. implement basic throttle() </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-debounce">6. implement basic debounce()</a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-debounce-with-leading-and-trailing-option">7. implement debounce() with leading &amp; trailing option</a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/throttle-Promises">92. throttle Promises</a></p>
<p>基于上一题的版本增加一个判断</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">wait</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> </span>option.leading</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> </span>option.trailing</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait, option = &#123;leading: <span class="literal">true</span>, trailing: <span class="literal">true</span>&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="comment">// Track if we are waiting. Initially, we are not.</span></span><br><span class="line">  <span class="keyword">let</span> isWaiting = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// Track arguments of last call</span></span><br><span class="line">  <span class="keyword">let</span> lastCallArgs = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleTimer = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    isWaiting = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (lastCallArgs &amp;&amp; option.trailing) &#123;</span><br><span class="line">      <span class="comment">// ...allow execution of &#x27;func&#x27;</span></span><br><span class="line">      func.apply(<span class="built_in">this</span>, lastCallArgs);</span><br><span class="line">      lastCallArgs = <span class="literal">null</span>;</span><br><span class="line">      <span class="comment">// Prevent future execution of &#x27;func&#x27;</span></span><br><span class="line">      isWaiting = <span class="literal">true</span>;</span><br><span class="line">      <span class="built_in">setTimeout</span>(handleTimer, wait);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">throttled</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// If we are waiting,</span></span><br><span class="line">    <span class="keyword">if</span> (isWaiting) &#123;</span><br><span class="line">      <span class="comment">// ...store arguments of last call</span></span><br><span class="line">      lastCallArgs = args;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// If we are not waiting, execute &#x27;func&#x27; with passed arguments</span></span><br><span class="line">    <span class="keyword">if</span> (option.leading) &#123;</span><br><span class="line">      func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Prevent future execution of &#x27;func&#x27;</span></span><br><span class="line">    isWaiting = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// After wait time,</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(handleTimer, wait);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-implement-basic-debounce"><a href="#6-implement-basic-debounce" class="headerlink" title="6. implement basic debounce()"></a>6. implement basic debounce()</h3><p>Debounce is a common technique used in Web Application, in most cases using <a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#debounce">lodash solution</a> would be a good choice.</p>
<p>could you implement your own version of basic <code>debounce()</code>?</p>
<p>In case you forgot, <code>debounce(func, delay)</code> will returned a debounced function, which delays the invoke.</p>
<p>Here is an example.</p>
<p>Before debouncing we have a series of calling like</p>
<p>─A─B─C─ ─D─ ─ ─ ─ ─ ─E─ ─F─G</p>
<p>After debouncing at wait time of 3 dashes</p>
<p>─ ─ ─ ─ ─ ─ ─ ─ D ─ ─ ─ ─ ─ ─ ─ ─ ─ G</p>
<p><strong>notes</strong></p>
<ol>
<li>please follow above spec. the behavior might not be exactly the same as <code>lodash.debounce()</code></li>
<li>because <code>window.setTimeout</code> and <code>window.clearTimeout</code> are not accurate in browser environment, they are replaced to other implementation when judging your code. They still have the same interface, and internally keep track of the timing for testing purpose.</li>
</ol>
<p>Something like below will be used to do the test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> currentTime = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> run = <span class="function">(<span class="params">input</span>) =&gt;</span> &#123;</span><br><span class="line">  currentTime = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> calls = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> func = <span class="function">(<span class="params">arg</span>) =&gt;</span> &#123;</span><br><span class="line">     calls.push(<span class="string">`<span class="subst">$&#123;arg&#125;</span>@<span class="subst">$&#123;currentTime&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> debounced = debounce(func, <span class="number">3</span>)</span><br><span class="line">  input.forEach(<span class="function">(<span class="params">call</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> [arg, time] = call.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> debounced(arg), time)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> calls</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">expect(run([<span class="string">&#x27;A@0&#x27;</span>, <span class="string">&#x27;B@2&#x27;</span>, <span class="string">&#x27;C@3&#x27;</span>])).toEqual([<span class="string">&#x27;C@5&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Related-to-question-1-how-could-you-implement-debouncing-Say-you-wanted-the-handleScroll-function-to-be-called-only-aft-QTN_1221446.htm">Source for this </a></p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-throttle">4. implement basic throttle() </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-throttle-with-leading-and-trailing-option">5. implement throttle() with leading &amp; trailing option </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-debounce-with-leading-and-trailing-option">7. implement debounce() with leading &amp; trailing option</a></p>
<p>基本版防抖，使用定时器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">wait</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">debounced</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (timer) <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line"></span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125;, wait)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-implement-debounce-with-leading-amp-trailing-option"><a href="#7-implement-debounce-with-leading-amp-trailing-option" class="headerlink" title="7. implement debounce() with leading &amp; trailing option"></a>7. implement debounce() with leading &amp; trailing option</h3><p>This is a follow up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-debounce">6. implement basic debounce()</a>, please refer to it for detailed explanation.</p>
<p>In this problem, you are asked to implement an enhanced <code>debounce()</code> which accepts third parameter, <code>option: &#123;leading: boolean, trailing: boolean&#125;</code></p>
<ol>
<li>leading: whether to invoke right away</li>
<li>trailing: whether to invoke after the delay.</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-debounce()">6. implement basic debounce()</a> is the default case with <code>&#123;leading: false, trailing: true&#125;</code>.</p>
<p>for the previous example of debouncing by 3 dashes</p>
<p>─A─B─C─ ─D─ ─ ─ ─ ─ ─ E─ ─F─G</p>
<p>with {leading: false, trailing: true}, we get as below</p>
<p>─ ─ ─ ─ ─ ─ ─ ─D─ ─ ─ ─ ─ ─ ─ ─ ─ G</p>
<p>with {leading: true, trailing: true}:</p>
<p>─A─ ─ ─ ─ ─ ─ ─D─ ─ ─E─ ─ ─ ─ ─ ─G</p>
<p>with {leading: true, trailing: false}</p>
<p>─A─ ─ ─ ─ ─ ─ ─ ─ ─ ─E</p>
<p>with {leading: false, trailing: false}, of course, nothing happens.</p>
<p><strong>notes</strong></p>
<ol>
<li>please follow above spec. the behavior might not be exactly the same as <code>lodash.debounce()</code></li>
<li>because <code>window.setTimeout</code> and <code>window.clearTimeout</code> are not accurate in browser environment, they are replaced to other implementation when judging your code. They still have the same interface, and internally keep track of the timing for testing purpose.</li>
</ol>
<p>Something like below will be used to do the test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> currentTime = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> run = <span class="function">(<span class="params">input</span>) =&gt;</span> &#123;</span><br><span class="line">  currentTime = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> calls = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> func = <span class="function">(<span class="params">arg</span>) =&gt;</span> &#123;</span><br><span class="line">     calls.push(<span class="string">`<span class="subst">$&#123;arg&#125;</span>@<span class="subst">$&#123;currentTime&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> debounced = debounce(func, <span class="number">3</span>)</span><br><span class="line">  input.forEach(<span class="function">(<span class="params">call</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> [arg, time] = call.split(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> debounced(arg), time)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> calls</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">expect(run([<span class="string">&#x27;A@0&#x27;</span>, <span class="string">&#x27;B@2&#x27;</span>, <span class="string">&#x27;C@3&#x27;</span>])).toEqual([<span class="string">&#x27;C@6&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-throttle">4. implement basic throttle() </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-throttle-with-leading-and-trailing-option">5. implement throttle() with leading &amp; trailing option </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-basic-debounce">6. implement basic debounce() </a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">wait</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> </span>option.leading</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> </span>option.trailing</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait, option = &#123;leading: <span class="literal">false</span>, trailing: <span class="literal">true</span>&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> nextArgs = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">debounced</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (option.leading &amp;&amp; !timer) &#123;</span><br><span class="line">      func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">      nextArgs = args;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (option.trailing &amp;&amp; nextArgs) &#123;</span><br><span class="line">        func.apply(<span class="built_in">this</span>, nextArgs);</span><br><span class="line">      &#125;</span><br><span class="line">      timer = <span class="literal">null</span>;</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-can-you-shuffle-an-array"><a href="#8-can-you-shuffle-an-array" class="headerlink" title="8. can you shuffle() an array?"></a>8. can you shuffle() an array?</h3><p>How would you implement a shuffle() ?</p>
<p>When passed with an array, it should modify the array inline to generate a randomly picked permutation at the same probability.</p>
<p>for an array like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>there would be possibly 4! = 24 permutations</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<p>your <code>shuffle()</code> should transform the array in one of the above array, at the same 1/24 probability.</p>
<p><em>notes</em></p>
<p>Your <code>shuffle()</code> will be called multiple times, to calculate the probability on each possible result, and test again <a target="_blank" rel="noopener" href="https://simple.wikipedia.org/wiki/Standard_deviation">standard deviation</a></p>
<p>ref: <a target="_blank" rel="noopener" href="https://javascript.info/task/shuffle">https://javascript.info/task/shuffle</a></p>
<p>采用从后向前的顺序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param <span class="type">&#123;any[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shuffle</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// modify the arr inline to change the order randomly</span></span><br><span class="line">  <span class="keyword">const</span> length = arr.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="keyword">let</span> random = <span class="built_in">Math</span>.floor((i + <span class="number">1</span>) * <span class="built_in">Math</span>.random());</span><br><span class="line">      [arr[i], arr[random]] = [arr[random], arr[i]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-decode-message"><a href="#9-decode-message" class="headerlink" title="9. decode message"></a>9. decode message</h3><p>Your are given a 2-D array of characters. There is a hidden message in it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I B C A L K A</span><br><span class="line">D R F C A E A</span><br><span class="line">G H O E L A D </span><br></pre></td></tr></table></figure>

<p>The way to collect the message is as follows</p>
<ol>
<li>start at top left</li>
<li>move diagonally down right</li>
<li>when cannot move any more, try to switch to diagonally up right</li>
<li>when cannot move any more, try switch to diagonally down right, repeat 3</li>
<li>stop when cannot neither move down right or up right. the character on the path is the message</li>
</ol>
<p>for the input above, <code>IROCLED</code> should be returned.</p>
<p><em>notes</em></p>
<p>if no characters could be collected, return empty string</p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Given-a-grid-of-characters-output-a-decoded-message-The-message-for-the-following-would-be-IROCKA-diagonally-down-right-QTN_970049.htm">Source for this </a></p>
<p>模拟碰到上下边界反弹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string[][]&#125;</span> <span class="variable">message</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> rows = message.length;</span><br><span class="line">  <span class="keyword">if</span> (rows === <span class="number">0</span>) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> cols = message[<span class="number">0</span>].length;</span><br><span class="line">  <span class="keyword">if</span> (cols === <span class="number">0</span>) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> row = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> col = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> directionY = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (col &lt; cols &amp;&amp; row &gt; -<span class="number">1</span> &amp;&amp; row &lt; rows) &#123;</span><br><span class="line">    res += message[row][col];</span><br><span class="line">    col += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    row += directionY;</span><br><span class="line">    <span class="keyword">if</span> (row &gt; rows - <span class="number">1</span>) &#123;</span><br><span class="line">      directionY = -<span class="number">1</span>;</span><br><span class="line">      row -= <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (row &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      directionY = <span class="number">1</span>;</span><br><span class="line">      row += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-first-bad-version"><a href="#10-first-bad-version" class="headerlink" title="10. first bad version"></a>10. first bad version</h3><p>Say you have multiple versions of a program, write a program that will find and return the first bad revision given a <code>isBad(version)</code> function.</p>
<p>Versions after first bad version are supposed to be all bad versions.</p>
<p><em>notes</em></p>
<ol>
<li>Inputs are all non-negative integers</li>
<li>if none found, return -1</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/If-you-have-500-revisions-of-a-program-write-a-program-that-will-find-and-return-the-FIRST-bad-revision-given-a-isBad-revi-QTN_1255475.htm">Source for this </a></p>
<p>二分查找都搜索满足条件的下边界</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> type TypIsBad = (version: number) =&gt; boolean</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;TypIsBad&#125;</span> </span>isBad </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firstBadVersion</span>(<span class="params">isBad</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// firstBadVersion receive a check function isBad</span></span><br><span class="line">  <span class="comment">// and should return a closure which accepts a version number(integer)</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">version</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// write your code to return the first bad version</span></span><br><span class="line">    <span class="comment">// if none found, return -1</span></span><br><span class="line">    <span class="keyword">let</span> low = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> high = version;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">      <span class="keyword">const</span> mid = low + <span class="built_in">Math</span>.floor((high - low) / <span class="number">2</span>);</span><br><span class="line">      <span class="keyword">if</span> (isBad(mid)) &#123;</span><br><span class="line">        high = mid - <span class="number">1</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        low = mid + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> low &lt;= version ? low : -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-what-is-Composition-create-a-pipe"><a href="#11-what-is-Composition-create-a-pipe" class="headerlink" title="11. what is Composition? create a pipe()"></a>11. what is Composition? create a pipe()</h3><p>what is Composition? It is actually not that difficult to understand, see <a target="_blank" rel="noopener" href="https://whatthefuck.is/composition">@dan_abramov ‘s explanation</a>.</p>
<p>Here you are asked to create a <code>pipe()</code> function, which chains multiple functions together to create a new function.</p>
<p>Suppose we have some simple functions like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> times = <span class="function">(<span class="params">y</span>) =&gt;</span>  <span class="function">(<span class="params">x</span>) =&gt;</span> x * y</span><br><span class="line"><span class="keyword">const</span> plus = <span class="function">(<span class="params">y</span>) =&gt;</span> <span class="function">(<span class="params">x</span>) =&gt;</span> x + y</span><br><span class="line"><span class="keyword">const</span> subtract = <span class="function">(<span class="params">y</span>) =&gt;</span>  <span class="function">(<span class="params">x</span>) =&gt;</span> x - y</span><br><span class="line"><span class="keyword">const</span> divide = <span class="function">(<span class="params">y</span>) =&gt;</span> <span class="function">(<span class="params">x</span>) =&gt;</span> x / y</span><br></pre></td></tr></table></figure>

<p>Your <code>pipe()</code> would be used to generate new functions</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pipe([</span><br><span class="line">  times(<span class="number">2</span>),</span><br><span class="line">  times(<span class="number">3</span>)</span><br><span class="line">])  </span><br><span class="line"><span class="comment">// x * 2 * 3</span></span><br><span class="line"></span><br><span class="line">pipe([</span><br><span class="line">  times(<span class="number">2</span>),</span><br><span class="line">  plus(<span class="number">3</span>),</span><br><span class="line">  times(<span class="number">4</span>)</span><br><span class="line">]) </span><br><span class="line"><span class="comment">// (x * 2 + 3) * 4</span></span><br><span class="line"></span><br><span class="line">pipe([</span><br><span class="line">  times(<span class="number">2</span>),</span><br><span class="line">  subtract(<span class="number">3</span>),</span><br><span class="line">  divide(<span class="number">4</span>)</span><br><span class="line">]) </span><br><span class="line"><span class="comment">// (x * 2 - 3) / 4</span></span><br></pre></td></tr></table></figure>

<p><strong>notes</strong></p>
<ol>
<li>to make things simple, functions passed to <code>pipe()</code> will all accept 1 argument</li>
</ol>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-sequence">29. implement async helper - <code>sequence()</code></a></p>
<p>管道化，正向使用reduce进行计算</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&lt;(arg: any) =&gt; any&gt;&#125;</span> </span>funcs </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(arg: any) =&gt; any&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pipe</span>(<span class="params">funcs</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function">(<span class="params">arg</span>) =&gt;</span> funcs.reduce(<span class="function">(<span class="params">arg, func</span>) =&gt;</span> func(arg), arg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-implement-Immutability-helper"><a href="#12-implement-Immutability-helper" class="headerlink" title="12. implement Immutability helper"></a>12. implement Immutability helper</h3><p>If you use React, you would meet the scenario to copy the state for a slight change.</p>
<p>For example, for following state</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  a: &#123;</span><br><span class="line">    b: &#123;</span><br><span class="line">      c: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  d: <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>if we are to modify d to a new state, we could use <a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#cloneDeep">_.cloneDeep</a>, but it is not efficient because <code>state.a</code> is cloned while we don’t need to change that.</p>
<p>A better way is to do shallow copy like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newState = &#123;</span><br><span class="line">  ...state,</span><br><span class="line">  d: <span class="number">3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>now is the problem, if we want to modify <code>c</code>, we would have to do something like</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newState = &#123;</span><br><span class="line">  ...state,</span><br><span class="line">  a: &#123;</span><br><span class="line">    ...state.a,</span><br><span class="line">    b: &#123;</span><br><span class="line">       ...state.b,</span><br><span class="line">       c: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can see that for simple data structure it would be enough to use spread operator, but for complex data structures, it is verbose.</p>
<p>Here comes the <a target="_blank" rel="noopener" href="https://reactjs.org/docs/update.html">Immutability Helper</a>, you are asked to implement your own Immutability Helper <code>update()</code>, which supports following features.</p>
<h4 id="1-push-array-push-all-the-items-in-array-on-the-target"><a href="#1-push-array-push-all-the-items-in-array-on-the-target" class="headerlink" title="1. {$push: array} push() all the items in array on the target."></a>1. <code>&#123;$push: array&#125;</code> push() all the items in array on the target.</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">const</span> newArr = update(arr, &#123;<span class="attr">$push</span>: [<span class="number">5</span>, <span class="number">6</span>]&#125;)</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></table></figure>

<h4 id="2-set-any-replace-the-target"><a href="#2-set-any-replace-the-target" class="headerlink" title="2. {$set: any} replace the target"></a>2. {$set: any} replace the target</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  a: &#123;</span><br><span class="line">    b: &#123;</span><br><span class="line">      c: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  d: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newState = update(</span><br><span class="line">  state, </span><br><span class="line">  &#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>: &#123; <span class="attr">c</span>: &#123;<span class="attr">$set</span>: <span class="number">3</span>&#125;&#125;&#125;&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  a: &#123;</span></span><br><span class="line"><span class="comment">    b: &#123;</span></span><br><span class="line"><span class="comment">      c: 3</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  &#125;,</span></span><br><span class="line"><span class="comment">  d: 2</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>Notice that we could also update array elements with <code>$set</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">const</span> newArr = update(</span><br><span class="line">  arr, </span><br><span class="line">  &#123;<span class="number">0</span>: &#123;<span class="attr">$set</span>: <span class="number">0</span>&#125;&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">//  [0, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<h4 id="3-merge-object-merge-object-to-the-location"><a href="#3-merge-object-merge-object-to-the-location" class="headerlink" title="3. {$merge: object} merge object to the location"></a>3. {$merge: object} merge object to the location</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  a: &#123;</span><br><span class="line">    b: &#123;</span><br><span class="line">      c: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  d: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newState = update(</span><br><span class="line">  state, </span><br><span class="line">  &#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>: &#123; <span class="attr">$merge</span>: &#123;<span class="attr">e</span>: <span class="number">5</span>&#125;&#125;&#125;&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  a: &#123;</span></span><br><span class="line"><span class="comment">    b: &#123;</span></span><br><span class="line"><span class="comment">      c: 1,</span></span><br><span class="line"><span class="comment">      e: 5</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  &#125;,</span></span><br><span class="line"><span class="comment">  d: 2</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="4-apply-function-custom-replacer"><a href="#4-apply-function-custom-replacer" class="headerlink" title="4. {$apply: function} custom replacer"></a>4. {$apply: function} custom replacer</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">const</span> newArr = update(arr, &#123;<span class="number">0</span>: &#123;<span class="attr">$apply</span>: <span class="function">(<span class="params">item</span>) =&gt;</span> item * <span class="number">2</span>&#125;&#125;)</span><br><span class="line"><span class="comment">// [2, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<p>根据键名分别进行相应的函数处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isObject = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> data === <span class="string">&#x27;object&#x27;</span> &amp;&amp; data !== <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> <span class="variable">command</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">data, command</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;$push&#x27;</span> <span class="keyword">in</span> command) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(data)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;not array&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      ...data,</span><br><span class="line">      ...command[<span class="string">&#x27;$push&#x27;</span>]</span><br><span class="line">    ];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;$merge&#x27;</span> <span class="keyword">in</span> command) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isObject(data)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;not object for $merge&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      ...data,</span><br><span class="line">      ...command[<span class="string">&#x27;$merge&#x27;</span>]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;$apply&#x27;</span> <span class="keyword">in</span> command) &#123;</span><br><span class="line">    <span class="keyword">return</span> command[<span class="string">&#x27;$apply&#x27;</span>](data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;$set&#x27;</span> <span class="keyword">in</span> command) &#123;</span><br><span class="line">    <span class="keyword">return</span> command[<span class="string">&#x27;$set&#x27;</span>];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isObject(data)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;not object for complex data&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> newData = <span class="built_in">Array</span>.isArray(data) ? [...data] : &#123;...data&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(command)) &#123;</span><br><span class="line">    newData[key] = update(newData[key], command[key]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-Implement-a-Queue-by-using-Stack"><a href="#13-Implement-a-Queue-by-using-Stack" class="headerlink" title="13. Implement a Queue by using Stack"></a>13. Implement a Queue by using Stack</h3><p>In JavaScript, we could use array to work as both a Stack or a queue.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">arr.push(<span class="number">5</span>) <span class="comment">// now array is [1, 2, 3, 4, 5]</span></span><br><span class="line">arr.pop() <span class="comment">// 5, now the array is [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<p>Above code is a Stack, while below is a Queue</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">arr.push(<span class="number">5</span>) <span class="comment">// now the array is [1, 2, 3, 4, 5]</span></span><br><span class="line">arr.shift() <span class="comment">// 1, now the array is [2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>

<p>now suppose you have a stack, which has only follow interface:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">push</span>(<span class="params">element</span>)</span> &#123; <span class="comment">/* add element to stack */</span> &#125;</span><br><span class="line">  <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span> &#123; <span class="comment">/* get the top element */</span> &#125;</span><br><span class="line">  <span class="function"><span class="title">pop</span>(<span class="params"></span>)</span> &#123; <span class="comment">/* remove the top element */</span>&#125;</span><br><span class="line">  <span class="function"><span class="title">size</span>(<span class="params"></span>)</span> &#123; <span class="comment">/* count of elements */</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Could you implement a Queue by using only above Stack? A Queue must have following interface</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">enqueue</span>(<span class="params">element</span>)</span> &#123; <span class="comment">/* add element to queue, similar to Array.prototype.push */</span> &#125;</span><br><span class="line">  <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span> &#123; <span class="comment">/* get the head element*/</span> &#125;</span><br><span class="line">  <span class="function"><span class="title">dequeue</span>(<span class="params"></span>)</span> &#123; <span class="comment">/* remove the head element, similar to Array.prototype.pop */</span> &#125;</span><br><span class="line">  <span class="function"><span class="title">size</span>(<span class="params"></span>)</span> &#123; <span class="comment">/* count of elements */</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>note</em></p>
<p>you can only use Stack as provided, Array should be avoided for the purpose of practicing.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/Implement-a-Stack-by-using-Queue">108. Implement a Stack by using Queue</a></p>
<p>最后的代码使用了2个栈</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* you can use this Class which is bundled together with your code</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">class Stack &#123;</span></span><br><span class="line"><span class="comment">  push(element) &#123; // add element to stack &#125;</span></span><br><span class="line"><span class="comment">  peek() &#123; // get the top element &#125;</span></span><br><span class="line"><span class="comment">  pop() &#123; // remove the top element&#125;</span></span><br><span class="line"><span class="comment">  size() &#123; // count of element &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Array is disabled in your code */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// you need to complete the following Class</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> </span>&#123;</span><br><span class="line">  <span class="title">constructor</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.stack1 = <span class="keyword">new</span> Stack();</span><br><span class="line">    <span class="built_in">this</span>.stack2 = <span class="keyword">new</span> Stack();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">enqueue</span>(<span class="params">element</span>)</span> &#123; </span><br><span class="line">    <span class="comment">// add new element to the rare</span></span><br><span class="line">    <span class="built_in">this</span>.stack1.push(element);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span> &#123; </span><br><span class="line">    <span class="comment">// get the head element</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.stack2.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.stack2.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">this</span>.stack1.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.stack2.push(<span class="built_in">this</span>.stack1.pop());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.stack2.peek();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">size</span>(<span class="params"></span>)</span> &#123; </span><br><span class="line">    <span class="comment">// return count of element</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.stack1.size() + <span class="built_in">this</span>.stack2.size();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">dequeue</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// remove the head element</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.stack2.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.stack2.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">this</span>.stack1.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.stack2.push(<span class="built_in">this</span>.stack1.pop());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.stack2.pop();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="14-Implement-a-general-memoization-function-memo"><a href="#14-Implement-a-general-memoization-function-memo" class="headerlink" title="14. Implement a general memoization function - memo()"></a>14. Implement a general memoization function - <code>memo()</code></h3><p><a target="_blank" rel="noopener" href="https://whatthefuck.is/memoization">Memoization</a> is a common technique to boost performance. If you use React, you definitely have used <code>React.memo</code> before.</p>
<p>Memoization is also commonly used in algorithm problem, when you have a recursion solution, in most cases, you can improve it by memoization, and then you might be able to get a Dynamic Programming approach.</p>
<p>So could you implement a general <code>memo()</code> function, which caches the result once called, so when same arguments are passed in, the result will be returned right away.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> func = <span class="function">(<span class="params">arg1, arg2</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> arg1 + arg2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> memoed = memo(func)</span><br><span class="line"></span><br><span class="line">memoed(<span class="number">1</span>, <span class="number">2</span>) </span><br><span class="line"><span class="comment">// 3, func is called</span></span><br><span class="line"></span><br><span class="line">memoed(<span class="number">1</span>, <span class="number">2</span>) </span><br><span class="line"><span class="comment">// 3 is returned right away without calling func</span></span><br><span class="line"></span><br><span class="line">memoed(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// 4, new arguments, so func is called</span></span><br></pre></td></tr></table></figure>

<p>The arguments are arbitrary, so memo should accept an extra resolver parameter, which is used to generate the cache key, like what <a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#memoize">_.memoize()</a> does.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> memoed = memo(func, <span class="function">() =&gt;</span> <span class="string">&#x27;samekey&#x27;</span>)</span><br><span class="line"></span><br><span class="line">memoed(<span class="number">1</span>, <span class="number">2</span>) </span><br><span class="line"><span class="comment">// 3, func is called, 3 is cached with key &#x27;samekey&#x27;</span></span><br><span class="line"></span><br><span class="line">memoed(<span class="number">1</span>, <span class="number">2</span>) </span><br><span class="line"><span class="comment">// 3, since key is the same, 3 is returned without calling func</span></span><br><span class="line"></span><br><span class="line">memoed(<span class="number">1</span>, <span class="number">3</span>) </span><br><span class="line"><span class="comment">// 3, since key is the same, 3 is returned without calling func</span></span><br></pre></td></tr></table></figure>

<p>Default cache key could be just <code>Array.from(arguments).join(&#39;_&#39;)</code></p>
<p><em>note</em></p>
<p>It is a trade-off of space for time, so if you use this in an interview, please do analyze how much space it might cost.</p>
<p><a target="_blank" rel="noopener" href="https://whatthefuck.is/memoization">Source for this </a></p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-memoizeOne">122. implement memoizeOne()</a></p>
<p>使用了map+闭包保存之前计算的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;(args:[]) =&gt; string &#125;</span>  </span>[resolver] - cache key generator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">memo</span>(<span class="params">func, resolver</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> cache = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> key = resolver ? resolver(...args) : args.join(<span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cache.has(key)) &#123;</span><br><span class="line">      <span class="keyword">return</span> cache.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> result = func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    cache.set(key, result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-implement-a-simple-DOM-wrapper-to-support-method-chaining-like-jQuery"><a href="#15-implement-a-simple-DOM-wrapper-to-support-method-chaining-like-jQuery" class="headerlink" title="15. implement a simple DOM wrapper to support method chaining like jQuery"></a>15. implement a simple DOM wrapper to support method chaining like jQuery</h3><p>I believe you’ve used jQuery before, we often chain the jQuery methods together to accomplish our goals.</p>
<p>For example, below chained call turns button into a black button with white text.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#button&#x27;</span>)</span><br><span class="line">  .css(<span class="string">&#x27;color&#x27;</span>, <span class="string">&#x27;#fff&#x27;</span>)</span><br><span class="line">  .css(<span class="string">&#x27;backgroundColor&#x27;</span>, <span class="string">&#x27;#000&#x27;</span>)</span><br><span class="line">  .css(<span class="string">&#x27;fontWeight&#x27;</span>, <span class="string">&#x27;bold&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>The chaining makes the code simple to read, could you create a simple wrapper <code>$</code> to make above code work as expected?</p>
<p>The wrapper only needs to have <code>css(propertyName: string, value: any)</code></p>
<p>通过返回的闭包设置参数，返回this实现链式调用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement&#125;</span> <span class="variable">el</span></span> - element to be wrapped</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    css: <span class="function"><span class="keyword">function</span>(<span class="params">property, value</span>) </span>&#123;</span><br><span class="line">      el.style[property] = value;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="16-create-an-Event-Emitter"><a href="#16-create-an-Event-Emitter" class="headerlink" title="16. create an Event Emitter"></a>16. create an Event Emitter</h3><p>There is <a target="_blank" rel="noopener" href="https://nodejs.org/api/events.html#events_class_eventemitter">Event Emitter in Node.js</a>, Facebook once had <a target="_blank" rel="noopener" href="https://github.com/facebookarchive/emitter">its own implementation</a> but now it is archived.</p>
<p>You are asked to create an Event Emitter Class</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> emitter = <span class="keyword">new</span> Emitter()</span><br></pre></td></tr></table></figure>

<p>It should support event subscribing</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sub1  = emitter.subscribe(<span class="string">&#x27;event1&#x27;</span>, callback1)</span><br><span class="line"><span class="keyword">const</span> sub2 = emitter.subscribe(<span class="string">&#x27;event2&#x27;</span>, callback2)</span><br><span class="line"></span><br><span class="line"><span class="comment">// same callback could subscribe </span></span><br><span class="line"><span class="comment">// on same event multiple times</span></span><br><span class="line"><span class="keyword">const</span> sub3 = emitter.subscribe(<span class="string">&#x27;event1&#x27;</span>, callback1)</span><br></pre></td></tr></table></figure>

<p><code>emit(eventName, ...args)</code> is used to trigger the callbacks, with args relayed</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">emitter.emit(<span class="string">&#x27;event1&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// callback1 will be called twice</span></span><br></pre></td></tr></table></figure>

<p>Subscription returned by <code>subscribe()</code> has a <code>release()</code> method that could be used to unsubscribe</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sub1.release()</span><br><span class="line">sub3.release()</span><br><span class="line"><span class="comment">// now even if we emit &#x27;event1&#x27; again, </span></span><br><span class="line"><span class="comment">// callback1 is not called anymore</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Flatten-Array-Create-Emitter-QTN_2559028.htm">Source for this </a></p>
<p>发布订阅模式的简化版，subscribe订阅事件，emit发布事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// please complete the implementation</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventEmitter</span> </span>&#123;</span><br><span class="line">  <span class="title">constructor</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.callbacks = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">subscribe</span>(<span class="params">eventName, callback</span>)</span> &#123;</span><br><span class="line">  	<span class="keyword">if</span> (<span class="built_in">this</span>.callbacks.has(eventName)) &#123;</span><br><span class="line">      <span class="keyword">const</span> callbacks = <span class="built_in">this</span>.callbacks.get(eventName);</span><br><span class="line">      callbacks.push(callback)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.callbacks.set(eventName, [callback]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      release: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> callbacks = <span class="built_in">this</span>.callbacks.get(eventName);</span><br><span class="line">        <span class="keyword">const</span> index = callbacks.indexOf(callback);</span><br><span class="line">        callbacks.splice(index, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">emit</span>(<span class="params">eventName, ...args</span>)</span> &#123;</span><br><span class="line">  	<span class="keyword">const</span> callbacks = <span class="built_in">this</span>.callbacks.get(eventName);</span><br><span class="line">    <span class="keyword">if</span> (!callbacks.length) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> callback <span class="keyword">of</span> callbacks) &#123;</span><br><span class="line">      callback.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="17-Create-a-simple-store-for-DOM-element"><a href="#17-Create-a-simple-store-for-DOM-element" class="headerlink" title="17. Create a simple store for DOM element"></a>17. Create a simple store for DOM element</h3><p>We have <code>Map</code> in es6, so we could use any data as key, such as DOM element.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">map.set(domNode, somedata)</span><br></pre></td></tr></table></figure>

<p>What if we need to support old JavaScript env like es5, how would you create your own Node Store as above?</p>
<p>You are asked to implement a Node Store, which supports DOM element as key.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NodeStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">node, value</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">node</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">has</span>(<span class="params">node</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>note</em></p>
<p>Map is disabled when judging your code, it is against the goal of practicing.</p>
<p>You can create a simple general Map polyfill. Or since you are asked to support specially for DOM element, what is special about DOM element?</p>
<p>What is the Time / Space cost of your solution?</p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Implement-a-simple-store-class-with-set-Node-value-get-Node-and-has-Node-methods-which-store-a-given-Nodes-with-corre-QTN_2435822.htm">Source for this </a></p>
<p>使用对象存储节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NodeStore</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.nodes = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;Node&#125;</span> <span class="variable">node</span></span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">value</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">node, value</span>)</span> &#123;</span><br><span class="line">   node.__id__ = <span class="built_in">Symbol</span>();</span><br><span class="line">   <span class="built_in">this</span>.nodes[node.__id__] = value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;Node&#125;</span> <span class="variable">node</span></span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return <span class="type">&#123;any&#125;</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">node</span>)</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="built_in">this</span>.nodes[node.__id__];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;Node&#125;</span> <span class="variable">node</span></span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return <span class="type">&#123;Boolean&#125;</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">has</span>(<span class="params">node</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> !!<span class="built_in">this</span>.nodes[node.__id__];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="18-Improve-a-function"><a href="#18-Improve-a-function" class="headerlink" title="18. Improve a function"></a>18. Improve a function</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Given an input of array, </span></span><br><span class="line"><span class="comment">// which is made of items with &gt;= 3 properties</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> items = [</span><br><span class="line">  &#123;<span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;tv&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>&#125;, </span><br><span class="line">  &#123;<span class="attr">color</span>: <span class="string">&#x27;silver&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;phone&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;book&#x27;</span>, <span class="attr">age</span>: <span class="number">17</span>&#125;</span><br><span class="line">] </span><br><span class="line"></span><br><span class="line"><span class="comment">// an exclude array made of key value pair</span></span><br><span class="line"><span class="keyword">const</span> excludes = [ </span><br><span class="line">  &#123;<span class="attr">k</span>: <span class="string">&#x27;color&#x27;</span>, <span class="attr">v</span>: <span class="string">&#x27;silver&#x27;</span>&#125;, </span><br><span class="line">  &#123;<span class="attr">k</span>: <span class="string">&#x27;type&#x27;</span>, <span class="attr">v</span>: <span class="string">&#x27;tv&#x27;</span>&#125;, </span><br><span class="line">  ...</span><br><span class="line">] </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">excludeItems</span>(<span class="params">items, excludes</span>) </span>&#123; </span><br><span class="line">  excludes.forEach( <span class="function"><span class="params">pair</span> =&gt;</span> &#123; </span><br><span class="line">    items = items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item[pair.k] === item[pair.v])</span><br><span class="line">  &#125;)</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> items</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ol>
<li>What does this function <code>excludeItems</code> do?</li>
<li>Is this function working as expected ?</li>
<li>What is the time complexity of this function?</li>
<li>How would you optimize it ?</li>
</ol>
<p><em>note</em></p>
<p>we only judge by the result, not the time cost. please submit the best approach you can.</p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Given-input-could-be-potentially-more-than-3-keys-in-the-object-above-items-color-red-type-tv-age-18-QTN_2372314.htm">Source for this </a></p>
<p>建立map，过滤需要进行过滤的key</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;object[]&#125;</span> <span class="variable">items</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@excludes <span class="type">&#123; Array&lt; &#123;k: string, v: any&#125;</span> </span>&gt;&#125; excludes</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;object[]&#125;</span> <span class="variable">items</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123; Array&lt; &#123;k: string, v: any&#125;</span> </span>&gt;&#125; excludes</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;object[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">excludeItems</span>(<span class="params">items, excludes</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> excludesMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> &#123;k, v&#125; <span class="keyword">of</span> excludes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!excludesMap.has(k)) &#123;</span><br><span class="line">      excludesMap.set(k, <span class="keyword">new</span> <span class="built_in">Set</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    excludesMap.get(k).add(v);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> items.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.keys(item).every(</span><br><span class="line">      key =&gt; !excludesMap.has(key) || !excludesMap.get(key).has(item[key])</span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="19-find-corresponding-node-in-two-identical-DOM-tree"><a href="#19-find-corresponding-node-in-two-identical-DOM-tree" class="headerlink" title="19. find corresponding node in two identical DOM tree"></a>19. find corresponding node in two identical DOM tree</h3><p>Given two same DOM tree <strong>A</strong>, <strong>B</strong>, and an Element <strong>a</strong> in <strong>A</strong>, find the corresponding Element <strong>b</strong> in <strong>B</strong>.</p>
<p>By <strong>corresponding</strong>, we mean <strong>a</strong> and <strong>b</strong> have the same relative position to their DOM tree root.</p>
<p><em>follow up</em></p>
<p>This could a problem on general Tree structure with only <code>children</code>.</p>
<p>Could you solve it recursively and iteratively?</p>
<p>Could you solve this problem with special DOM api for better performance?</p>
<p>What are the time cost for each solution?</p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Given-two-identical-DOM-trees-not-the-same-one-and-a-node-from-one-of-them-find-the-node-in-the-other-one-QTN_2435821.htm">Source for this </a></p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/get-DOM-tree-height">58. get DOM tree height</a></p>
<p>使用迭代法进行操作，用队列保存层级节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement&#125;</span> <span class="variable">rootA</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement&#125;</span> <span class="variable">rootB</span></span> - rootA and rootB are clone of each other</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement&#125;</span> <span class="variable">nodeA</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> findCorrespondingNode = <span class="function">(<span class="params">rootA, rootB, target</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> stackA = [rootA];</span><br><span class="line">  <span class="keyword">let</span> stackB = [rootB];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (stackA.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> nodeA = stackA.pop();</span><br><span class="line">    <span class="keyword">const</span> nodeB = stackB.pop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (nodeA === target) &#123;</span><br><span class="line">      <span class="keyword">return</span> nodeB;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stackA.push(...nodeA.childNodes);</span><br><span class="line">    stackB.push(...nodeB.childNodes);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="20-Detect-data-type-in-JavaScript"><a href="#20-Detect-data-type-in-JavaScript" class="headerlink" title="20. Detect data type in JavaScript"></a>20. Detect data type in JavaScript</h3><p>This is an easy problem.</p>
<p>For <a target="_blank" rel="noopener" href="https://javascript.info/types">all the basic data types</a> in JavaScript, how could you write a function to detect the type of arbitrary data?</p>
<p>Besides basic types, you need to also handle also commonly used complex data type including <code>Array</code>, <code>ArrayBuffer</code>, <code>Map</code>, <code>Set</code>, <code>Date</code> and <code>Function</code></p>
<p>The goal is not to list up all the data types but to show us how to solve the problem when we need to.</p>
<p>The type should be lowercase</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">detectType(<span class="number">1</span>) <span class="comment">// &#x27;number&#x27;</span></span><br><span class="line">detectType(<span class="keyword">new</span> <span class="built_in">Map</span>()) <span class="comment">// &#x27;map&#x27;</span></span><br><span class="line">detectType([]) <span class="comment">// &#x27;array&#x27;</span></span><br><span class="line">detectType(<span class="literal">null</span>) <span class="comment">// &#x27;null&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// more in judging step</span></span><br></pre></td></tr></table></figure>

<p>除了常规的判断，测试用例中有一个FileReader需要返回<code>object</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectType</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (data === <span class="literal">null</span>) <span class="keyword">return</span> <span class="string">&#x27;null&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> data !== <span class="string">&#x27;object&#x27;</span>) <span class="keyword">return</span> <span class="keyword">typeof</span> data;</span><br><span class="line">  <span class="keyword">if</span> (data <span class="keyword">instanceof</span> FileReader) <span class="keyword">return</span> <span class="string">&#x27;object&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(data).replace(<span class="string">&#x27;[object &#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#x27;</span>).toLowerCase();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="21-implement-JSON-stringify"><a href="#21-implement-JSON-stringify" class="headerlink" title="21. implement JSON.stringify()"></a>21. implement JSON.stringify()</h3><p>I believe you’ve used <code>JSON.stringify()</code> before, do you know the details of how it handles arbitrary data?</p>
<p>Please have a guess on the details and then take a look at the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">explanation on MDN</a>, it is actually pretty complex.</p>
<p>In this problem, you are asked to implement your own version of <code>JSON.stringify()</code>.</p>
<p>In a real interview, you are not expected to cover all the cases, just decide the scope with interviewer. But for a goal of practicing, your code here will be tested against a lot of data types. Please try to cover as much as you can.</p>
<p>Attention to the circular reference.</p>
<p><em>note</em></p>
<p><code>JSON.stringify()</code> support two more parameters which is not required here.</p>
<p><strong>Don’t use JSON.stringify() in your code here</strong>, it doesn’t help you practicing coding skills.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-JSON-parse">22. implement JSON.parse()</a></p>
<p>分类进行判断，注意不能枚举的键</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stringify</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> type = <span class="keyword">typeof</span> data;</span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;bigint&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;Do not know how to serialize a BigInt at JSON.stringify&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/undefined|symbol/</span>.test(type) || data === <span class="literal">null</span> || <span class="built_in">Object</span>.is(data, <span class="literal">NaN</span>) || data === <span class="literal">Infinity</span> || data === -<span class="literal">Infinity</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;null&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&quot;<span class="subst">$&#123;data&#125;</span>&quot;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (type !== <span class="string">&#x27;object&#x27;</span>) &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(data <span class="keyword">instanceof</span> <span class="built_in">Date</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&quot;<span class="subst">$&#123;data.toISOString()&#125;</span>&quot;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(data)) &#123;</span><br><span class="line">    <span class="comment">// 递归调用</span></span><br><span class="line">    <span class="keyword">const</span> arr = data.map(<span class="function">(<span class="params">el</span>) =&gt;</span> stringify(el));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`[<span class="subst">$&#123;arr.join(<span class="string">&#x27;,&#x27;</span>)&#125;</span>]`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">      </span><br><span class="line">  <span class="keyword">const</span> arr = <span class="built_in">Object</span>.entries(data).reduce(<span class="function">(<span class="params">acc, [key, value]</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(value === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;</span><br><span class="line">    acc.push(<span class="string">`&quot;<span class="subst">$&#123;key&#125;</span>&quot;:<span class="subst">$&#123;stringify(value)&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> acc;</span><br><span class="line">  &#125;, []);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&#123;<span class="subst">$&#123;arr.join(<span class="string">&#x27;,&#x27;</span>)&#125;</span>&#125;`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="22-implement-JSON-parse"><a href="#22-implement-JSON-parse" class="headerlink" title="22. implement JSON.parse()"></a>22. implement JSON.parse()</h3><p>I believe you’ve used <code>JSON.stringify()</code> before, do you know the details of how it handles arbitrary data?</p>
<p>Please have a guess on the details and then take a look at the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">explanation on MDN</a>, it is actually pretty complex.</p>
<p>In this problem, you are asked to implement your own version of <code>JSON.stringify()</code>.</p>
<p>In a real interview, you are not expected to cover all the cases, just decide the scope with interviewer. But for a goal of practicing, your code here will be tested against a lot of data types. Please try to cover as much as you can.</p>
<p>Attention to the circular reference.</p>
<p><em>note</em></p>
<p><strong>Don’t use JSON.parse() in your code here</strong> It doesn’t help you practicing your skills.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-JSON-stringify">21. implement JSON.stringify() </a></p>
<p>使用eval，注意有可能失败，重新JSON.stringify()转化后不同于自身</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">str</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;object | Array | string | number | boolean | null&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> parsed = <span class="built_in">eval</span>(<span class="string">&#x27;(&#x27;</span> + str + <span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (str !== <span class="built_in">JSON</span>.stringify(parsed)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> parsed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用递归写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">str</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;object | Array | string | number | boolean | null&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dataType = detectDataType(str);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (dataType === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> parseObj(str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (dataType === <span class="string">&#x27;array&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> parseArr(str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> parsePrimitive(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectDataType</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (str.startsWith(<span class="string">&#x27;&#123;&#x27;</span>) &amp;&amp; str.endsWith(<span class="string">&#x27;&#125;&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;object&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (str.startsWith(<span class="string">&#x27;[&#x27;</span>) &amp;&amp; str.endsWith(<span class="string">&#x27;]&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;array&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;primitive&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseObj</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  str = removeQuotationMarks(str);</span><br><span class="line">  <span class="keyword">if</span> (str.endsWith(<span class="string">&#x27;:&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (str.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> regex = <span class="regexp">/^&quot;.+?&quot;(?=:)/</span>;</span><br><span class="line">    <span class="keyword">let</span> key = str.match(regex);</span><br><span class="line">    <span class="keyword">if</span> (!key) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    key = key[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> rest = str.slice(key.length + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> val = rest.match(<span class="regexp">/\w+(?=,&quot;\w+&quot;:)/</span>);</span><br><span class="line">    <span class="keyword">if</span> (!val) &#123;</span><br><span class="line">      val = rest;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      val = val[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> trimmedKey = removeQuotationMarks(key);</span><br><span class="line">    obj[trimmedKey] = parse(val);</span><br><span class="line"></span><br><span class="line">    str = rest.slice(val.length);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseArr</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> arr = [];</span><br><span class="line"></span><br><span class="line">  str = removeQuotationMarks(str);</span><br><span class="line">  <span class="keyword">if</span> (str.endsWith(<span class="string">&#x27;,&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (str.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> item = str.match(<span class="regexp">/.+?,(?!&quot;\w+&quot;:)/</span>);</span><br><span class="line">    <span class="keyword">if</span> (!item) &#123;</span><br><span class="line">      item = str;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      item = item[<span class="number">0</span>].slice(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    arr.push(parse(item));</span><br><span class="line"></span><br><span class="line">    str = str.slice(item.length + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parsePrimitive</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (str.startsWith(<span class="string">&#x27;&quot;&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> removeQuotationMarks(str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(str)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Number</span>(str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (str === <span class="string">&#x27;true&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (str === <span class="string">&#x27;false&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (str === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeQuotationMarks</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.slice(<span class="number">1</span>, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="23-create-a-sum"><a href="#23-create-a-sum" class="headerlink" title="23. create a sum()"></a>23. create a sum()</h3><p>Create a <code>sum()</code>, which makes following possible</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sum1 = sum(<span class="number">1</span>)</span><br><span class="line">sum1(<span class="number">2</span>) == <span class="number">3</span> <span class="comment">// true</span></span><br><span class="line">sum1(<span class="number">3</span>) == <span class="number">4</span> <span class="comment">// true</span></span><br><span class="line">sum(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>) == <span class="number">6</span> <span class="comment">// true</span></span><br><span class="line">sum(<span class="number">5</span>)(-<span class="number">1</span>)(<span class="number">2</span>) == <span class="number">6</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>函数柯里化+valueOf求值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">num</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> add = <span class="function"><span class="params">newNum</span> =&gt;</span> newNum ? sum(num + newNum) : num;</span><br><span class="line">  add.valueOf = <span class="function">() =&gt;</span> num;</span><br><span class="line">  <span class="keyword">return</span> add;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="24-create-a-sum"><a href="#24-create-a-sum" class="headerlink" title="24. create a sum()"></a>24. create a sum()</h3><p><a target="_blank" rel="noopener" href="https://storm.cis.fordham.edu/~yli/documents/CISC2200Spring15/Graph.pdf">Priority Queue</a> is a commonly used data structure in algorithm problem. Especially useful for <strong>Top K</strong> problem with a huge amount of input data, since it could avoid sorting the whole but keep a fixed-length sorted portion of it.</p>
<p>Since there is no built-in Priority Queue in JavaScript, in a real interview, you should tell interview saying that “Suppose we already have a Priority Queue Class I can use”, there is no time for you to write a Priority Queue from scratch.</p>
<p>But it is a good coding problem to practice, so please implement a Priority Queue with following interface</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span> </span>&#123;</span><br><span class="line">  <span class="comment">// compare is a function defines the priority, which is the order</span></span><br><span class="line">  <span class="comment">// the elements closer to first element is sooner to be removed.</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">compare</span>)</span> &#123;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// add a new element to the queue</span></span><br><span class="line">  <span class="comment">// you need to put it in the right order</span></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">element</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remove the head element and return</span></span><br><span class="line">  <span class="function"><span class="title">poll</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the head element</span></span><br><span class="line">  <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the amount of items in the queue</span></span><br><span class="line">  <span class="function"><span class="title">size</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here is an example to make it clearer</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pq = <span class="keyword">new</span> PriorityQueue(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b)</span><br><span class="line"><span class="comment">// (a, b) =&gt; a - b means</span></span><br><span class="line"><span class="comment">// smaller numbers are closer to index:0</span></span><br><span class="line"><span class="comment">// which means smaller number are to be removed sooner</span></span><br><span class="line"></span><br><span class="line">pq.add(<span class="number">5</span>)</span><br><span class="line"><span class="comment">// now 5 is the only element</span></span><br><span class="line"></span><br><span class="line">pq.add(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 2 added</span></span><br><span class="line"></span><br><span class="line">pq.add(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// 1 added</span></span><br><span class="line"></span><br><span class="line">pq.peek()</span><br><span class="line"><span class="comment">// since smaller number are sooner to be removed</span></span><br><span class="line"><span class="comment">// so this gives us 1</span></span><br><span class="line"></span><br><span class="line">pq.poll()</span><br><span class="line"><span class="comment">// 1 </span></span><br><span class="line"><span class="comment">// 1 is removed, 2 and 5 are left</span></span><br><span class="line"></span><br><span class="line">pq.peek()</span><br><span class="line"><span class="comment">// 2 is the smallest now, this returns 2</span></span><br><span class="line"></span><br><span class="line">pq.poll()</span><br><span class="line"><span class="comment">// 2 </span></span><br><span class="line"><span class="comment">// 2 is removed, only 5 is left</span></span><br></pre></td></tr></table></figure>

<p>实现堆，这个直接抄了，感觉比较复杂，主要是上移和下移操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// complete the implementation</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span> </span>&#123;</span><br><span class="line">  heap = [];</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;(a: any, b: any) =&gt; -1 | 0 | 1&#125;</span> <span class="variable">compare</span></span> - </span></span><br><span class="line"><span class="comment">   * compare function, similar to parameter of Array.prototype.sort</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">compare</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.compare = compare;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * return &#123;number&#125; amount of items</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">size</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.heap.length;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * returns the head element</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.heap.length ? <span class="built_in">this</span>.heap[<span class="number">0</span>] : <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">element</span></span> - new element to add</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">element</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.heap.push(element);</span><br><span class="line">    <span class="keyword">const</span> heapSize = <span class="built_in">this</span>.size();</span><br><span class="line">    <span class="keyword">if</span> (heapSize &gt; <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.heapifyUp(heapSize - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * remove the head element</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return <span class="type">&#123;any&#125;</span> </span>the head element</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">poll</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> heapSize = <span class="built_in">this</span>.size();</span><br><span class="line">    <span class="keyword">if</span> (heapSize &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.heap.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.swap(<span class="number">0</span>, heapSize - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">const</span> head = <span class="built_in">this</span>.heap.pop();</span><br><span class="line">    <span class="built_in">this</span>.heapifyDown(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">heapifyUp</span>(<span class="params">index</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> parentIndex = <span class="built_in">Math</span>.floor((index - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (parentIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> comparison = <span class="built_in">this</span>.compare(<span class="built_in">this</span>.heap[index], <span class="built_in">this</span>.heap[parentIndex]);</span><br><span class="line">    <span class="keyword">if</span> (comparison &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.swap(index, parentIndex);</span><br><span class="line">      <span class="built_in">this</span>.heapifyUp(parentIndex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">heapifyDown</span>(<span class="params">parentIndex</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> leftIndex = <span class="number">2</span> * parentIndex + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> rightIndex = <span class="number">2</span> * parentIndex + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">let</span> swappableIndex = parentIndex;</span><br><span class="line">    <span class="keyword">const</span> heapSize = <span class="built_in">this</span>.size();</span><br><span class="line">    <span class="keyword">let</span> comparison = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (leftIndex &lt; heapSize) &#123;</span><br><span class="line">      comparison = <span class="built_in">this</span>.compare(</span><br><span class="line">        <span class="built_in">this</span>.heap[leftIndex],</span><br><span class="line">        <span class="built_in">this</span>.heap[swappableIndex]</span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">if</span> (comparison &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        swappableIndex = leftIndex;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rightIndex &lt; heapSize) &#123;</span><br><span class="line">      comparison = <span class="built_in">this</span>.compare(</span><br><span class="line">        <span class="built_in">this</span>.heap[rightIndex],</span><br><span class="line">        <span class="built_in">this</span>.heap[swappableIndex]</span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">if</span> (comparison &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        swappableIndex = rightIndex;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (swappableIndex !== parentIndex) &#123;</span><br><span class="line">      <span class="built_in">this</span>.swap(parentIndex, swappableIndex);</span><br><span class="line">      <span class="built_in">this</span>.heapifyDown(swappableIndex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">swap</span>(<span class="params">i, j</span>)</span> &#123;</span><br><span class="line">    [<span class="built_in">this</span>.heap[i], <span class="built_in">this</span>.heap[j]] = [<span class="built_in">this</span>.heap[j], <span class="built_in">this</span>.heap[i]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="25-Reorder-array-with-new-indexes"><a href="#25-Reorder-array-with-new-indexes" class="headerlink" title="25. Reorder array with new indexes"></a>25. Reorder array with new indexes</h3><p>Suppose we have an array of items - <code>A</code>, and another array of indexes in numbers - <code>B</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> A = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> B = [<span class="number">1</span>,   <span class="number">5</span>,   <span class="number">4</span>,   <span class="number">3</span>,   <span class="number">2</span>,   <span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p>You need to reorder A, so that the A[i] is put at index of B[i], which means B is the new index for each item of A.</p>
<p>For above example A should be modified inline to following</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>The input are always valid.</p>
<p><em>follow-up</em></p>
<p>It is fairly easy to do this by using extra <code>O(n)</code> space, could you solve it with <code>O(1)</code> space?</p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Given-an-input-array-and-another-array-that-describes-a-new-index-for-each-element-mutate-the-input-array-so-that-each-ele-QTN_446534.htm">Source for this </a></p>
<p>一次遍历重新排序索引和数据，保证当前位置是正确的数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any[]&#125;</span> <span class="variable">items</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">newOrder</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params">items, newOrder</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// reorder items inline</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; newOrder.length; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> newIndex = newOrder[i];</span><br><span class="line">    <span class="keyword">if</span> (newIndex !== i) &#123;</span><br><span class="line">      swap(newOrder, newIndex, i);</span><br><span class="line">      swap(items, newIndex, i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">arr, i, j</span>) </span>&#123;</span><br><span class="line">  [arr[i], arr[j]] = [arr[j], arr[i]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="26-implement-Object-assign"><a href="#26-implement-Object-assign" class="headerlink" title="26. implement Object.assign()"></a>26. implement Object.assign()</h3><p><em>The <code>Object.assign()</code> method copies all enumerable own properties from one or more source objects to a target object. It returns the target object.</em> (source: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">MDN</a>)</p>
<p>It is widely used, Object Spread operator actually is internally the same as <code>Object.assign()</code> (<a target="_blank" rel="noopener" href="https://github.com/tc39/proposal-object-rest-spread/blob/master/Spread.md">source</a>). Following 2 lines of code are totally the same.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> aClone = &#123; ...a &#125;;</span><br><span class="line"><span class="keyword">let</span> aClone = <span class="built_in">Object</span>.assign(&#123;&#125;, a);</span><br></pre></td></tr></table></figure>

<p>This is an easy one, could you implement <code>Object.assign()</code> with your own implementation ?</p>
<p><em>note</em></p>
<p><strong>Don’t use Object.assign() in your code</strong> It doesn’t help improve your skills</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-completeAssign">27. implement completeAssign()</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">completeAssign</span>(<span class="params">target, ...sources</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (!target) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title">constructor</span> = <span class="title">Object</span>.<span class="title">getPrototypeOf</span>(<span class="params">target</span>).<span class="title">constructor</span>;</span><br><span class="line">    target = <span class="keyword">new</span> <span class="title">constructor</span>(<span class="params">target</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> source <span class="keyword">of</span> sources) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!source) &#123;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>.defineProperties(target, <span class="built_in">Object</span>.getOwnPropertyDescriptors(source));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> symbol <span class="keyword">of</span> <span class="built_in">Object</span>.getOwnPropertySymbols(source)) &#123;</span><br><span class="line">      target[symbol] = source[symbol];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="27-implement-completeAssign"><a href="#27-implement-completeAssign" class="headerlink" title="27. implement completeAssign()"></a>27. implement completeAssign()</h3><p>This is a follow-up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-object-assign">26. implement Object.assign()</a>.</p>
<p><code>Object.assign()</code> assigns the enumerable properties, so getters are not copied, non-enumerable properties are ignored.</p>
<p>Suppose we have following source object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> source = <span class="built_in">Object</span>.create(</span><br><span class="line">  &#123;</span><br><span class="line">    a: <span class="number">3</span> <span class="comment">// prototype</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    b: &#123;</span><br><span class="line">      value: <span class="number">4</span>,</span><br><span class="line">      enumerable: <span class="literal">true</span> <span class="comment">// enumerable data descriptor</span></span><br><span class="line">    &#125;,</span><br><span class="line">    c: &#123;</span><br><span class="line">      value: <span class="number">5</span>, <span class="comment">// non-enumerable data descriptor</span></span><br><span class="line">    &#125;,</span><br><span class="line">    d: &#123; <span class="comment">// non-enumerable accessor descriptor </span></span><br><span class="line">      get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>._d;</span><br><span class="line">      &#125;,</span><br><span class="line">      set: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>._d = value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    e: &#123; <span class="comment">// enumerable accessor descriptor </span></span><br><span class="line">      get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>._e;</span><br><span class="line">      &#125;,</span><br><span class="line">      set: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>._e = value</span><br><span class="line">      &#125;,</span><br><span class="line">      enumerable: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>If we call <code>Object.assign()</code> with source of above, we get:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.assign(&#123;&#125;, source)</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123;b: 4, e: undefined&#125;</span></span><br><span class="line"><span class="comment">// e is undefined because `this._e` is undefined</span></span><br></pre></td></tr></table></figure>

<p>Rather than above result, could you implement a <code>completeAssign()</code> which have the same parameters as <code>Object.assign()</code> but fully copies the data descriptors and accessor descriptors?</p>
<p>In case you are not familiar with the descriptors, <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">this page from MDN</a> might help.</p>
<p>This problem is solely checking your understanding of how property descriptors work.</p>
<p>Good luck</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-object-assign">26. implement Object.assign() </a></p>
<p>类似的做法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">completeAssign</span>(<span class="params">target, ...sources</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (target === <span class="literal">null</span> || target === <span class="literal">undefined</span>) <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">&#x27;target cannot be null or undefined&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  target = <span class="built_in">Object</span>(target);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> source <span class="keyword">of</span> sources) &#123;</span><br><span class="line">    <span class="keyword">if</span> (source === <span class="literal">null</span> || target === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>.defineProperties(target, <span class="built_in">Object</span>.getOwnPropertyDescriptors(source));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> symbol <span class="keyword">of</span> <span class="built_in">Object</span>.getOwnPropertySymbols(source)) &#123;</span><br><span class="line">      target[symbol] = source[symbol];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="28-implement-clearAllTimeout"><a href="#28-implement-clearAllTimeout" class="headerlink" title="28. implement clearAllTimeout()"></a>28. implement clearAllTimeout()</h3><p><code>window.setTimeout()</code> could be used to schedule some task in the future.</p>
<p>Could you implement <code>clearAllTimeout()</code> to clear all the timers ? This might be useful when we want to clear things up before page transition.</p>
<p>For example</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(func1, <span class="number">10000</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(func2, <span class="number">10000</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(func3, <span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// all 3 functions are scheduled 10 seconds later</span></span><br><span class="line">clearAllTimeout()</span><br><span class="line"></span><br><span class="line"><span class="comment">// all scheduled tasks are cancelled.</span></span><br></pre></td></tr></table></figure>

<p><em>note</em></p>
<p>You need to keep the interface of <code>window.setTimeout</code> and <code>window.clearTimeout</code> the same, but you could replace them with new logic</p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/by-phone-what-is-a-difference-between-Object-and-Array-call-and-apply-what-is-DOM-structure-what-is-time-complexity-of-QTN_2882315.htm">Source for this </a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * cancel all timer from window.setTimeout</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> timerCache = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 包装setTimeout</span></span><br><span class="line"><span class="keyword">const</span> originalSetTimeout = <span class="built_in">window</span>.setTimeout;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.setTimeout = <span class="function">(<span class="params">cb, delay</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> timer = originalSetTimeout(cb, delay);</span><br><span class="line">  timerCache.add(timer);</span><br><span class="line">  <span class="keyword">return</span> timer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearAllTimeout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> timer <span class="keyword">of</span> timerCache) &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="29-implement-async-helper-sequence"><a href="#29-implement-async-helper-sequence" class="headerlink" title="29. implement async helper - sequence()"></a>29. implement async helper - <code>sequence()</code></h3><p>This problem is similar to <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/what-is-composition-create-a-pipe">11. what is Composition? create a pipe()</a>.</p>
<p>You are asked to implement an async function helper, <code>sequence()</code> which chains up async functions, like what <code>pipe()</code> does.</p>
<p>All async functions have following interface</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Callback = <span class="function">(<span class="params">error: <span class="built_in">Error</span>, data: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AsyncFunc = (</span><br><span class="line">   callback: Callback,</span><br><span class="line">   data: <span class="built_in">any</span></span><br><span class="line">) =&gt; <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>Your <code>sequence()</code> should <strong>accept AsyncFunc array</strong>, and <strong>chain them up by passing new data to the next AsyncFunc through data in Callback.</strong></p>
<p>Suppose we have an async func which just multiple a number by 2</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> asyncTimes2 = <span class="function">(<span class="params">callback, num</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> callback(<span class="literal">null</span>, num * <span class="number">2</span>), <span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Your <code>sequence()</code> should be able to accomplish this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> asyncTimes4 = sequence(</span><br><span class="line">  [</span><br><span class="line">    asyncTimes2,</span><br><span class="line">    asyncTimes2</span><br><span class="line">  ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">asyncTimes4(<span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data) <span class="comment">// 4</span></span><br><span class="line">&#125;, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>Once an error occurs, it should trigger the last callback without triggering the uncalled functions.</p>
<p><strong>Follow up</strong></p>
<p>Can you solve it with and without Promise?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/what-is-composition-create-a-pipe">11. what is Composition? create a pipe() </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-parallel">30. implement async helper - <code>parallel()</code></a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-race">async helper - <code>race()</code></a></p>
<p>使用promise实现</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Callback = (error: Error, data: any) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">type AsyncFunc = (</span></span><br><span class="line"><span class="comment">   callback: Callback,</span></span><br><span class="line"><span class="comment">   data: any</span></span><br><span class="line"><span class="comment">) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;AsyncFunc[]&#125;</span> <span class="variable">funcs</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(callback: Callback) =&gt; void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sequence</span>(<span class="params">funcs</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> promiseFuncs = funcs.map(promisify);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">callback, input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// init promise</span></span><br><span class="line">    <span class="keyword">let</span> promise = <span class="built_in">Promise</span>.resolve(input);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add all promiseFuncs to promise</span></span><br><span class="line">    promiseFuncs.forEach(<span class="function">(<span class="params">promiseFunc</span>) =&gt;</span> &#123;</span><br><span class="line">      promise = promise.then(promiseFunc);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// handle resolved or rejected promise</span></span><br><span class="line">    promise.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      callback(<span class="literal">undefined</span>, data)</span><br><span class="line">    &#125;).catch(callback);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promisify</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      callback(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          reject(err);</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resolve(data);</span><br><span class="line">      &#125;, ...args);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不使用promise实现</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Callback = (error: Error, data: any) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">type AsyncFunc = (</span></span><br><span class="line"><span class="comment">   callback: Callback,</span></span><br><span class="line"><span class="comment">   data: any</span></span><br><span class="line"><span class="comment">) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;AsyncFunc[]&#125;</span> <span class="variable">funcs</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(callback: Callback) =&gt; void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sequence</span>(<span class="params">funcs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> sequenced = <span class="function">(<span class="params">finalCallback, input</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (i === funcs.length) &#123;</span><br><span class="line">      finalCallback(<span class="literal">undefined</span>, input);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> func = funcs[i];</span><br><span class="line">    func(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        finalCallback(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      i++;</span><br><span class="line">      sequenced(finalCallback, data);</span><br><span class="line">    &#125;, input);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> sequenced;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="30-implement-async-helper-parallel"><a href="#30-implement-async-helper-parallel" class="headerlink" title="30. implement async helper - parallel()"></a>30. implement async helper - <code>parallel()</code></h3><p>This problem is related to <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-sequence">29. implement async helper - <code>sequence()</code></a>.</p>
<p>You are asked to implement an async function helper, <code>parallel()</code> which works like <code>Promise.all()</code>. Different from <code>sequence()</code>, the async function doesn’t wait for each other, rather they are all triggered together.</p>
<p>All async functions have following interface</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Callback = <span class="function">(<span class="params">error: <span class="built_in">Error</span>, data: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AsyncFunc = (</span><br><span class="line">   callback: Callback,</span><br><span class="line">   data: <span class="built_in">any</span></span><br><span class="line">) =&gt; <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>Your <code>parallel()</code> should <strong>accept AsyncFunc array</strong>, and return a new function which triggers its own callback when all async functions are done or an error occurs.</p>
<p>Suppose we have an 3 async functions</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> async1 = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">   callback(<span class="literal">undefined</span>, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> async2 = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">   callback(<span class="literal">undefined</span>, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> async3 = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">   callback(<span class="literal">undefined</span>, <span class="number">3</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Your <code>parallel()</code> should be able to accomplish this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> all = parallel(</span><br><span class="line">  [</span><br><span class="line">    async1,</span><br><span class="line">    async2,</span><br><span class="line">    async3</span><br><span class="line">  ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">all(<span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data) <span class="comment">// [1, 2, 3]</span></span><br><span class="line">&#125;, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>When error occurs, only first error is passed down to the last. Later errors or data are ignored.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-sequence">29. implement async helper - <code>sequence()</code> </a></p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-race">31. implement async helper - <code>race()</code></a></p>
<p>promisify+promise.all</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Callback = (error: Error, data: any) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">type AsyncFunc = (</span></span><br><span class="line"><span class="comment">   callback: Callback,</span></span><br><span class="line"><span class="comment">   data: any</span></span><br><span class="line"><span class="comment">) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;AsyncFunc[]&#125;</span> <span class="variable">funcs</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(callback: Callback) =&gt; void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parallel</span>(<span class="params">funcs</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback, ...args</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Promise</span>.all(funcs.map(<span class="function"><span class="params">func</span> =&gt;</span> promisify(func)(...args)))</span><br><span class="line">    .then(<span class="function">(<span class="params">res</span>) =&gt;</span> callback(<span class="literal">undefined</span>, res))</span><br><span class="line">    .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> callback(err, <span class="literal">undefined</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promisify</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      callback(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          reject(err);</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resolve(data);</span><br><span class="line">      &#125;, ...args);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不使用的话其实就是参考了Promise.all的原理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Callback = (error: Error, data: any) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">type AsyncFunc = (</span></span><br><span class="line"><span class="comment">   callback: Callback,</span></span><br><span class="line"><span class="comment">   data: any</span></span><br><span class="line"><span class="comment">) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;AsyncFunc[]&#125;</span> <span class="variable">funcs</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(callback: Callback) =&gt; void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parallel</span>(<span class="params">funcs</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">finalCallback, input</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> results = <span class="built_in">Array</span>(funcs.length);</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> hasError = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    funcs.forEach(<span class="function">(<span class="params">func, i</span>) =&gt;</span> &#123;</span><br><span class="line">      func(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (hasError) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          hasError = <span class="literal">true</span>;</span><br><span class="line">          finalCallback(err, <span class="literal">undefined</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        results[i] = data;</span><br><span class="line">        count++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (count === funcs.length) &#123;</span><br><span class="line">          finalCallback(<span class="literal">undefined</span>, results);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, input);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="31-implement-async-helper-race"><a href="#31-implement-async-helper-race" class="headerlink" title="31. implement async helper - race()"></a>31. implement async helper - <code>race()</code></h3><p>This problem is related to <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-parallel">30. implement async helper - <code>parallel()</code></a>.</p>
<p>You are asked to implement an async function helper, <code>race()</code> which works like <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race">Promise.race()</a>. Different from <code>parallel()</code> that waits for all functions to finish, <code>race()</code> will finish when any function is done or run into error.</p>
<p>All async functions have following interface</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Callback = <span class="function">(<span class="params">error: <span class="built_in">Error</span>, data: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AsyncFunc = (</span><br><span class="line">   callback: Callback,</span><br><span class="line">   data: <span class="built_in">any</span></span><br><span class="line">) =&gt; <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>Your <code>race()</code> should <strong>accept AsyncFunc array</strong>, and return a new function which triggers its own callback when <strong>any</strong> async function is done or an error occurs.</p>
<p>Suppose we have an 3 async functions</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> async1 = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> callback(<span class="literal">undefined</span>, <span class="number">1</span>), <span class="number">300</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> async2 = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> callback(<span class="literal">undefined</span>, <span class="number">2</span>), <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> async3 = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> callback(<span class="literal">undefined</span>, <span class="number">3</span>), <span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Your <code>race()</code> should be able to accomplish this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> first = race(</span><br><span class="line">  [</span><br><span class="line">    async1,</span><br><span class="line">    async2,</span><br><span class="line">    async3</span><br><span class="line">  ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">first(<span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data) <span class="comment">// 2, since 2 is the first to be given</span></span><br><span class="line">&#125;, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>When error occurs, only first error is passed down to the last. Later errors or data are ignored.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-sequence">29. implement async helper - <code>sequence()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-parallel">30. implement async helper - <code>parallel()</code> </a></p>
<p>使用Promise.race</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Callback = (error: Error, data: any) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">type AsyncFunc = (</span></span><br><span class="line"><span class="comment">   callback: Callback,</span></span><br><span class="line"><span class="comment">   data: any</span></span><br><span class="line"><span class="comment">) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;AsyncFunc[]&#125;</span> <span class="variable">funcs</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(callback: Callback) =&gt; void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">race</span>(<span class="params">funcs</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback, ...args</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Promise</span>.race(funcs.map(<span class="function"><span class="params">func</span> =&gt;</span> promisify(func)(...args)))</span><br><span class="line">    .then(<span class="function">(<span class="params">res</span>) =&gt;</span> callback(<span class="literal">undefined</span>, res))</span><br><span class="line">    .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> callback(err, <span class="literal">undefined</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promisify</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      callback(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          reject(err);</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resolve(data);</span><br><span class="line">      &#125;, ...args);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接使用其逻辑</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Callback = (error: Error, data: any) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">type AsyncFunc = (</span></span><br><span class="line"><span class="comment">   callback: Callback,</span></span><br><span class="line"><span class="comment">   data: any</span></span><br><span class="line"><span class="comment">) =&gt; void</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;AsyncFunc[]&#125;</span> <span class="variable">funcs</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;(callback: Callback) =&gt; void&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">race</span>(<span class="params">funcs</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">finalCallback, input</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> isExecuted = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> func <span class="keyword">of</span> funcs) &#123;</span><br><span class="line">      func(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isExecuted) &#123;</span><br><span class="line">          finalCallback(err, data);</span><br><span class="line">          isExecuted = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, input);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="32-implement-Promise-all"><a href="#32-implement-Promise-all" class="headerlink" title="32. implement Promise.all()"></a>32. implement <code>Promise.all()</code></h3><blockquote>
<p>The Promise.all() method takes an iterable of promises as an input, and returns a single Promise that resolves to an array of the results of the input promises</p>
</blockquote>
<p>source - <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all">MDN</a></p>
<p>Could you write your own <code>all()</code> ? which should works the same as <code>Promise.all()</code></p>
<p><em>note</em></p>
<p><strong>Do not use Promise.all() directly</strong>, it is not helping</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-parallel">30. implement async helper - <code>parallel()</code></a>plement <code>Promise.allSettled()</code>](<a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-allSettled)[34">https://bigfrontend.dev/problem/implement-Promise-allSettled)[34</a>. implement <code>Promise.any()</code>](<a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-any)ment">https://bigfrontend.dev/problem/implement-Promise-any)ment</a> <code>Promise.race()</code>](<a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-race">https://bigfrontend.dev/problem/implement-Promise-race</a>)</p>
<p>记录完成的数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&lt;any&gt;&#125;</span> <span class="variable">promises</span></span> - notice input might have non-Promises</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Promise&lt;any[]&gt;&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">all</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> n = promises.length;</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="number">0</span>) &#123;</span><br><span class="line">      resolve([]);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">new</span> <span class="built_in">Array</span>(n);</span><br><span class="line">    <span class="keyword">let</span> finishedLength = <span class="number">0</span>;</span><br><span class="line">    promises.forEach(<span class="function">(<span class="params">promise, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">Promise</span>.resolve(promise).then(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        res[index] = value;</span><br><span class="line">        finishedLength++;</span><br><span class="line">        <span class="keyword">if</span> (finishedLength === n) resolve(res);</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        reject(error);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="33-implement-Promise-allSettled"><a href="#33-implement-Promise-allSettled" class="headerlink" title="33. implement Promise.allSettled()"></a>33. implement <code>Promise.allSettled()</code></h3><blockquote>
<p>The Promise.allSettled() method returns a promise that resolves after all of the given promises have either fulfilled or rejected, with an array of objects that each describes the outcome of each promise.</p>
</blockquote>
<ul>
<li>from <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled">MDN</a></li>
</ul>
<p>Different from <code>Promise.all()</code> which rejects right away once an error occurs, <code>Promise.allSettled()</code> waits for all promises to settle.</p>
<p>Now can you implement your own <code>allSettled()</code> ?</p>
<p><em>note</em></p>
<p><strong>Do not use Promise.allSettled() directly</strong>, it helps nothing.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-parallel">30. implement async helper - <code>parallel()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-all">32. implement <code>Promise.all()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-any">34. implement <code>Promise.any()</code></a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-race">35. implement <code>Promise.race()</code></a></p>
<p>需要标记任务</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&lt;any&gt;&#125;</span> <span class="variable">promises</span></span> - notice that input might contains non-promises</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Promise&lt;Array&lt;&#123;status: &#x27;fulfilled&#x27;, value: any&#125;</span> </span>| &#123;status: &#x27;rejected&#x27;, reason: any&#125;&gt;&gt;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">allSettled</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (promises.length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve([]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> len = promises.length;</span><br><span class="line">  <span class="keyword">const</span> results = <span class="built_in">Array</span>(len);</span><br><span class="line">  <span class="keyword">let</span> finishedPromise = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    promises.forEach(<span class="function">(<span class="params">promise, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!(promise <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">        promise = <span class="built_in">Promise</span>.resolve(promise);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      promise.then(</span><br><span class="line">        (value) =&gt; &#123;</span><br><span class="line">          results[index] = &#123;</span><br><span class="line">            status: <span class="string">&#x27;fulfilled&#x27;</span>,</span><br><span class="line">            value,</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">          finishedPromise++;</span><br><span class="line">          <span class="keyword">if</span> (finishedPromise === len) &#123;</span><br><span class="line">            resolve(results);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        (reason) =&gt; &#123;</span><br><span class="line">          results[index] = &#123;</span><br><span class="line">            status: <span class="string">&#x27;rejected&#x27;</span>,</span><br><span class="line">            reason,</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">          finishedPromise++;</span><br><span class="line">          <span class="keyword">if</span> (finishedPromise === len) &#123;</span><br><span class="line">            resolve(results);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="34-implement-Promise-any"><a href="#34-implement-Promise-any" class="headerlink" title="34. implement Promise.any()"></a>34. implement <code>Promise.any()</code></h3><blockquote>
<p>Promise.any() takes an iterable of Promise objects and, as soon as one of the promises in the iterable fulfils, returns a single promise that resolves with the value from that promise</p>
</blockquote>
<ul>
<li>from <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/any">MDN</a></li>
</ul>
<p>Can you implement a <code>any()</code> to work the same as <code>Promise.any()</code>?</p>
<p><em>note</em></p>
<p><code>AggregateError</code> is not supported in Chrome yet, but you can still use it in your code since we will add the Class into your code. Do something like following:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> AggregateError(</span><br><span class="line">  <span class="string">&#x27;No Promise in Promise.any was resolved&#x27;</span>, </span><br><span class="line">  errors</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-all">32. implement <code>Promise.all()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-allSettled">33. implement <code>Promise.allSettled()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-race">35. implement <code>Promise.race()</code></a></p>
<p>类似的写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&lt;Promise&gt;&#125;</span> <span class="variable">promises</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Promise&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">any</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> errors = [];</span><br><span class="line">    <span class="keyword">const</span> len = promises.length;</span><br><span class="line">    <span class="keyword">let</span> rejectedPromise = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    promises.forEach(<span class="function">(<span class="params">promise, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!(promise <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">        promise = <span class="built_in">Promise</span>.resolve(promise);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      promise.then(</span><br><span class="line">        (value) =&gt; &#123;</span><br><span class="line">          resolve(value);</span><br><span class="line">        &#125;</span><br><span class="line">      ).catch(</span><br><span class="line">        (reason) =&gt; &#123;</span><br><span class="line">          errors[index] = reason;</span><br><span class="line"></span><br><span class="line">          rejectedPromise++;</span><br><span class="line">          <span class="keyword">if</span> (rejectedPromise === len) &#123;</span><br><span class="line">            reject(<span class="keyword">new</span> AggregateError(</span><br><span class="line">              <span class="string">&#x27;No Promise in Promise.any was resolved&#x27;</span>, </span><br><span class="line">              errors</span><br><span class="line">            ));</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="35-implement-Promise-race"><a href="#35-implement-Promise-race" class="headerlink" title="35. implement Promise.race()"></a>35. implement <code>Promise.race()</code></h3><p>This problem is similar to <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-async-helper-race">31. implement async helper - <code>race()</code></a>, but with Promise.</p>
<blockquote>
<p>The Promise.race() method returns a promise that fulfills or rejects as soon as one of the promises in an iterable fulfills or rejects, with the value or reason from that promise. <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race">source: MDN</a></p>
</blockquote>
<p>Can you create a <code>race()</code> which works the same as <code>Promise.race()</code>?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-all">32. implement <code>Promise.all()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-allSettled">33. implement <code>Promise.allSettled()</code> </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Promise-any">34. implement <code>Promise.any()</code> </a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&lt;Promise&gt;&#125;</span> <span class="variable">promises</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Promise&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">race</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (promises.length === <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> promise <span class="keyword">of</span> promises) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!promise <span class="keyword">instanceof</span> <span class="built_in">Promise</span>) promise = <span class="built_in">Promise</span>.resolve(promise);</span><br><span class="line">      promise.then(<span class="function"><span class="params">res</span> =&gt;</span> resolve(res)).catch(<span class="function"><span class="params">err</span> =&gt;</span> reject(err));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="36-create-a-fake-timer-setTimeout"><a href="#36-create-a-fake-timer-setTimeout" class="headerlink" title="36. create a fake timer(setTimeout)"></a>36. create a fake timer(setTimeout)</h3><p><code>setTimeout</code> adds task in to a task queue to be handled later, the time actually is no accurate. (<a target="_blank" rel="noopener" href="https://javascript.info/event-loop">Event Loop</a>).</p>
<p>This is OK in general web application, but might be problematic in test.</p>
<p>For example, at <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-throttle-with-leading-and-trailing-option">5. implement throttle() with leading &amp; trailing option</a> we need to test the timer with more accurate approach.</p>
<p>Could you implement your own <code>setTimeout()</code> and <code>clearTimeout()</code> to be sync? so that they have <strong>accurate timing</strong> for test. This is what <a target="_blank" rel="noopener" href="https://github.com/sinonjs/fake-timers">FakeTimes</a> are for.</p>
<p>By “accurate”, it means <strong>suppose all functions cost no time</strong>, we start our function at time <code>0</code>, then <code>setTimeout(func1, 100)</code> would schedule <code>func1</code> exactly at <code>100</code>.</p>
<p>You need to replace <code>Date.now()</code> as well to provide the time.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FakeTimer</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">install</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// setTimeout(), clearTimeout(), and Date.now() </span></span><br><span class="line">    <span class="comment">// are replaced</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">uninstall</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// restore the original APIs</span></span><br><span class="line">    <span class="comment">// setTimeout(), clearTimeout() and Date.now()</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">tick</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="comment">// run all the schedule functions in order</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Your code is tested like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fakeTimer = <span class="keyword">new</span> FakeTimer()</span><br><span class="line">fakeTimer.install()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> logs = []</span><br><span class="line"><span class="keyword">const</span> log = <span class="function">(<span class="params">arg</span>) =&gt;</span> &#123;</span><br><span class="line">   logs.push([<span class="built_in">Date</span>.now(), arg])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> log(<span class="string">&#x27;A&#x27;</span>), <span class="number">100</span>)</span><br><span class="line"><span class="comment">// log &#x27;A&#x27; at 100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> log(<span class="string">&#x27;B&#x27;</span>), <span class="number">110</span>)</span><br><span class="line"><span class="built_in">clearTimeout</span>(b)</span><br><span class="line"><span class="comment">// b is set but cleared</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> log(<span class="string">&#x27;C&#x27;</span>), <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">expect(logs).toEqual([[<span class="number">100</span>, <span class="string">&#x27;A&#x27;</span>], [<span class="number">200</span>, <span class="string">&#x27;C&#x27;</span>]])</span><br><span class="line"></span><br><span class="line">fakeTimer.uninstall()</span><br></pre></td></tr></table></figure>

<p><em>Note</em></p>
<p>Only <code>Date.now()</code> is used when judging your code, you can ignore other time related apis.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-a-fake-timer-setInterval">84. create a fake timer (setInterval)</a></p>
<p>使用队列存储任务，记录时间</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FakeTimer</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.taskQueue = [];</span><br><span class="line">    <span class="built_in">this</span>.currTime = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">install</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// replace window.setTimeout, window.clearTimeout, Date.now</span></span><br><span class="line">    <span class="comment">// with your implementation</span></span><br><span class="line">    <span class="built_in">this</span>.windowSetTimeOut = <span class="built_in">window</span>.setTimeout;</span><br><span class="line">    <span class="built_in">this</span>.windowClearTimeout = <span class="built_in">window</span>.clearTimeout;</span><br><span class="line">    <span class="built_in">this</span>.dateNow = <span class="built_in">Date</span>.now;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">window</span>.setTimeout = <span class="function">(<span class="params">cb, wait</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// accumulate the time for nested setTimeout calls.</span></span><br><span class="line">      wait += <span class="built_in">this</span>.currTime;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> task = &#123;</span><br><span class="line">        id: <span class="built_in">this</span>.taskQueue.length - <span class="number">1</span>,</span><br><span class="line">        cb,</span><br><span class="line">        wait,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="built_in">this</span>.taskQueue.push(task);</span><br><span class="line">      <span class="built_in">this</span>.taskQueue.sort(<span class="function">(<span class="params">taskA, taskB</span>) =&gt;</span> taskB.wait - taskA.wait);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> task.id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">window</span>.clearTimeout = <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// accumulate the time for nested setTimeout calls.</span></span><br><span class="line">      <span class="keyword">const</span> taskIndex = <span class="built_in">this</span>.taskQueue.findIndex(<span class="function">(<span class="params">task</span>) =&gt;</span> task.id === id);</span><br><span class="line">      <span class="built_in">this</span>.taskQueue.splice(taskIndex, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Date</span>.now = <span class="function">() =&gt;</span> <span class="built_in">this</span>.currTime;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">uninstall</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// restore the original implementation of</span></span><br><span class="line">    <span class="comment">// window.setTimeout, window.clearTimeout, Date.now</span></span><br><span class="line">    <span class="built_in">window</span>.setTimeout = <span class="built_in">this</span>.windowSetTimeOut;</span><br><span class="line">    <span class="built_in">window</span>.clearTimeout = <span class="built_in">this</span>.windowClearTimeout;</span><br><span class="line">    <span class="built_in">Date</span>.now = <span class="built_in">this</span>.dateNow;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">tick</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// run the scheduled functions without waiting</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">this</span>.taskQueue.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; cb, wait &#125; = <span class="built_in">this</span>.taskQueue.pop();</span><br><span class="line">      <span class="built_in">this</span>.currTime = wait;</span><br><span class="line">      cb();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="37-implement-Binary-Search-unique"><a href="#37-implement-Binary-Search-unique" class="headerlink" title="37. implement Binary Search (unique)"></a>37. implement Binary Search (unique)</h3><p>Even in Front-End review, basic algorithm technique like <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Binary_search_algorithm">Binary Search</a> are likely to be asked.</p>
<p>You are given an <strong>unique &amp; ascending</strong> array of integers, please search for its index with Binary Search.</p>
<p>If not found, return <code>-1</code></p>
<p><em>note</em></p>
<p>Please don’t use <code>Array.prototype.indexOf()</code>, it is not our goal.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-first-index-with-Binary-Search-duplicate-array">48. search first index with Binary Search(possible duplicate array)</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-last-index-with-Binary-Search-possible-duplicate-array">49. search last index with Binary Search(possible duplicate array)</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-element-right-before-target-with-Binary-Search-possible-duplicate-array">50. search element right before target with Binary Search(possible duplicate array)</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-element-right-after-target-with-Binary-Search-possible-duplicate-array">51. search element right after target with Binary Search(possible duplicate array)</a></p>
<p>二分查找</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span> - ascending unique array</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">target</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binarySearch</span>(<span class="params">arr, target</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">    <span class="keyword">const</span> mid = left + ((right - left) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (arr[mid] === target) &#123;</span><br><span class="line">      <span class="keyword">return</span> mid;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr[mid] &gt; target) &#123;</span><br><span class="line">      right = mid - <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      left = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr[left] === target ? left : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="38-implement-jest-spyOn"><a href="#38-implement-jest-spyOn" class="headerlink" title="38. implement jest.spyOn()"></a>38. implement <code>jest.spyOn()</code></h3><p>If you did unit test before, you must be familiar with <code>Spy</code>.</p>
<p>You are asked to create a <code>spyOn(object, methodName)</code>, which works the same as <a target="_blank" rel="noopener" href="https://jestjs.io/docs/en/jest-object#jestspyonobject-methodname">jest.spyOn()</a>.</p>
<p>To make it simple, here are the 2 requirements of <code>spyOn</code></p>
<ol>
<li>original method should be called when spied one is called</li>
<li>spy should have a <code>calls</code> array, which holds all the arguments in each call.</li>
</ol>
<p>Code to explain everything.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">   data: <span class="number">1</span>, </span><br><span class="line">   <span class="function"><span class="title">increment</span>(<span class="params">num</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.data += num</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> spy = spyOn(obj, <span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line"></span><br><span class="line">obj.increment(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj.data) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">obj.increment(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj.data) <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(spy.calls)</span><br><span class="line"><span class="comment">// [ [1], [2] ]</span></span><br></pre></td></tr></table></figure>

<p>返回一个spy对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;object&#125;</span> <span class="variable">obj</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">methodName</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">spyOn</span>(<span class="params">obj, methodName</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> spy = &#123;</span><br><span class="line">    calls: [],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> originalMethod = obj[methodName];</span><br><span class="line">  <span class="keyword">if</span> (!originalMethod || <span class="keyword">typeof</span> originalMethod !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  obj[methodName] = <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">    spy.calls.push(args);</span><br><span class="line">    originalMethod.apply(obj, args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> spy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="39-implement-range"><a href="#39-implement-range" class="headerlink" title="39. implement range()"></a>39. implement range()</h3><p>Can you create a <code>range(from, to)</code> which makes following work?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> num <span class="keyword">of</span> range(<span class="number">1</span>, <span class="number">4</span>)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(num)  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

<p>This is a simple one, could you think <strong>more fancy approaches other than for-loop</strong>?</p>
<p>Notice that you are not required to return an array, but something <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_iterator_protocol">iterable</a> would be fine</p>
<p>自己手写一版迭代器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;integer&#125;</span> <span class="variable">from</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;integer&#125;</span> <span class="variable">to</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">range</span>(<span class="params"><span class="keyword">from</span>, to</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// The iterator object that will be returned</span></span><br><span class="line">  <span class="comment">// when calling the Symbol.iterator method of an object.</span></span><br><span class="line">  <span class="comment">// The iterator object has a method named next which</span></span><br><span class="line">  <span class="comment">// generates values for the iteration.</span></span><br><span class="line">  <span class="keyword">const</span> iterator = &#123;</span><br><span class="line">    <span class="keyword">from</span>,</span><br><span class="line">    to,</span><br><span class="line">    <span class="function"><span class="title">next</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">this</span>.from &gt; <span class="built_in">this</span>.to) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          done: <span class="literal">true</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> value = &#123; <span class="attr">value</span>: <span class="built_in">this</span>.from, <span class="attr">done</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">      <span class="built_in">this</span>.from++;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Return an object that has a method named</span></span><br><span class="line">  <span class="comment">// Symbol.iterator for the for...of to work.</span></span><br><span class="line">  <span class="comment">// When for..of starts, it calls that method once.</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">      <span class="keyword">return</span> iterator;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用generator生成器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;integer&#125;</span> <span class="variable">from</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;integer&#125;</span> <span class="variable">to</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">range</span>(<span class="params"><span class="keyword">from</span>, to</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="keyword">from</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= to) &#123;</span><br><span class="line">      <span class="keyword">yield</span> i;</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> gen();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="40-implement-Bubble-Sort"><a href="#40-implement-Bubble-Sort" class="headerlink" title="40. implement Bubble Sort"></a>40. implement Bubble Sort</h3><p>Even for Front-End Engineer, it is a must to understand how basic sorting algorithms work.</p>
<p>Now you are asked to implement <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bubble_sort">Bubble Sort</a>, which sorts an integer array in ascending order.</p>
<p>Do it <strong>in-place</strong>, no need to return anything.</p>
<p><em>Follow-up</em></p>
<p>What is time cost for average / worst case ? Is it stable?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Merge-Sort">41. implement Merge Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Insertion-Sort">42. implement Insertion Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Quick-Sort">43. implement Quick Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Selection-Sort">44. implement Selection Sort</a></p>
<p>冒泡排序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> len = arr.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> swaped = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; len; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] &gt; arr[j]) &#123;</span><br><span class="line">        [arr[i], arr[j]] = [arr[j], arr[i]];</span><br><span class="line">        swaped = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!swaped) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="41-implement-Merge-Sort"><a href="#41-implement-Merge-Sort" class="headerlink" title="41. implement Merge Sort"></a>41. implement Merge Sort</h3><p>Even for Front-End Engineer, it is a must to understand how basic sorting algorithms work.</p>
<p>Now you are asked to implement <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Merge_sort">Merge Sort</a>, which sorts an integer array in ascending order.</p>
<p>Do it <strong>in-place</strong>, no need to return anything.</p>
<p><em>Follow-up</em></p>
<p>What is time cost for average / worst case ? Is it stable?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Bubble-Sort">40. implement Bubble Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Insertion-Sort">42. implement Insertion Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Quick-Sort">43. implement Quick Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Selection-Sort">44. implement Selection Sort</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  mergeSortImpl(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSortImpl</span>(<span class="params">arr, start, end</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (start &gt;= end) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">const</span> mid = start + <span class="built_in">Math</span>.floor((end - start) / <span class="number">2</span>);</span><br><span class="line">  mergeSortImpl(arr, start, mid);</span><br><span class="line">  mergeSortImpl(arr, mid + <span class="number">1</span>, end);</span><br><span class="line">  merge(arr, start, mid, end)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">arr, start, mid, end</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> lowHalf = [];</span><br><span class="line">  <span class="keyword">const</span> highHalf = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> k = start;</span><br><span class="line">  <span class="keyword">let</span> i;</span><br><span class="line">  <span class="keyword">let</span> j;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; k &lt;= mid; i++, k++) &#123;</span><br><span class="line">    lowHalf[i] = arr[k];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (j = <span class="number">0</span>; k &lt;= end; j++, k++) &#123;</span><br><span class="line">    highHalf[j] = arr[k];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  k = start;</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (i &lt; lowHalf.length &amp;&amp; j &lt; highHalf.length) &#123;</span><br><span class="line">    <span class="keyword">if</span> (lowHalf[i] &lt; highHalf[j]) &#123;</span><br><span class="line">      arr[k] = lowHalf[i];</span><br><span class="line">      i++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      arr[k] = highHalf[j];</span><br><span class="line">      j++;</span><br><span class="line">    &#125;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (i &lt; lowHalf.length) &#123;</span><br><span class="line">    arr[k] = lowHalf[i];</span><br><span class="line">    i++;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (j &lt; highHalf.length) &#123;</span><br><span class="line">    arr[k] = highHalf[j];</span><br><span class="line">    j++;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="42-implement-Insertion-Sort"><a href="#42-implement-Insertion-Sort" class="headerlink" title="42. implement Insertion Sort"></a>42. implement Insertion Sort</h3><p>Even for Front-End Engineer, it is a must to understand how basic sorting algorithms work.</p>
<p>Now you are asked to implement <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Insertion_sort">Insertion Sort</a>, which sorts an integer array in ascending order.</p>
<p>Do it <strong>in-place</strong>, no need to return anything.</p>
<p><em>Follow-up</em></p>
<p>What is time cost for average / worst case ? Is it stable?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Bubble-Sort">40. implement Bubble Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Merge-Sort">41. implement Merge Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Quick-Sort">43. implement Quick Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Selection-Sort">44. implement Selection Sort</a></p>
<p>插入排序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertionSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> currentVal = arr[i];</span><br><span class="line">    <span class="keyword">let</span> j = i - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; currentVal &lt; arr[j]) &#123;</span><br><span class="line">      arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">      j--;</span><br><span class="line">    &#125;</span><br><span class="line">    arr[j + <span class="number">1</span>] = currentVal;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="43-implement-Quick-Sort"><a href="#43-implement-Quick-Sort" class="headerlink" title="43. implement Quick Sort"></a>43. implement Quick Sort</h3><p>Even for Front-End Engineer, it is a must to understand how basic sorting algorithms work.</p>
<p>Now you are asked to implement <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Quicksort">Quick Sort</a>, which sorts an integer array in ascending order.</p>
<p>Do it <strong>in-place</strong>, no need to return anything.</p>
<p><em>Follow-up</em></p>
<p>What is time cost for average / worst case ? Is it stable?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Bubble-Sort">40. implement Bubble Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Merge-Sort">41. implement Merge Sort</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Insertion-Sort">42. implement Insertion Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Selection-Sort">44. implement Selection Sort</a></p>
<p>快速排序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  quickSortImpl(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSortImpl</span>(<span class="params">arr, low, high</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (low &gt;= high) <span class="keyword">return</span> ;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pivotIndex = partition(arr, low, high);</span><br><span class="line">  quickSortImpl(arr, low, pivotIndex - <span class="number">1</span>);</span><br><span class="line">  quickSortImpl(arr, pivotIndex + <span class="number">1</span>, high);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">arr, low, high</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> pivot = arr[high];</span><br><span class="line">  <span class="keyword">let</span> i = low;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = low; j &lt; high; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[j] &lt; pivot) &#123;</span><br><span class="line">      [arr[j], arr[i]] = [arr[i], arr[j]];</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  [arr[i], arr[high]] = [arr[high], arr[i]];</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="44-implement-Selection-Sort"><a href="#44-implement-Selection-Sort" class="headerlink" title="44. implement Selection Sort"></a>44. implement Selection Sort</h3><p>Even for Front-End Engineer, it is a must to understand how basic sorting algorithms work.</p>
<p>Now you are asked to implement <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Selection_sort">Selection sort</a>, which sorts an integer array in ascending order.</p>
<p>Do it <strong>in-place</strong>, no need to return anything.</p>
<p><em>Follow-up</em></p>
<p>What is time cost for average / worst case ? Is it stable?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Bubble-Sort">40. implement Bubble Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Merge-Sort">41. implement Merge Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Insertion-Sort">42. implement Insertion Sort </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Quick-Sort">43. implement Quick Sort </a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectionSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> smallestIndex = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &lt; arr[smallestIndex]) &#123;</span><br><span class="line">        smallestIndex = j;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (smallestIndex !== i) &#123;</span><br><span class="line">      [arr[smallestIndex], arr[i]] = [arr[i], arr[smallestIndex]];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="45-find-the-K-th-largest-element-in-an-unsorted-array"><a href="#45-find-the-K-th-largest-element-in-an-unsorted-array" class="headerlink" title="45. find the K-th largest element in an unsorted array"></a>45. find the K-th largest element in an unsorted array</h3><p>You are given an unsorted array of numbers, which might have duplicates, find the K-th largest element.</p>
<p>The naive approach would be sort it first, but it costs <code>O(nlogn)</code>, could you find a better approach?</p>
<p>Maybe you can recall what is happening in <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Quick-Sort">Quick Sort</a> or <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-a-priority-queue-in-JavaScript">Priority Queue</a></p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-a-priority-queue-in-JavaScript">24. create a Priority Queue in JavaScript </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Quick-Sort">43. implement Quick Sort </a><br>快速选择</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">k</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findKThLargest</span>(<span class="params">arr, k</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (k === <span class="number">0</span> || arr.length === <span class="number">0</span>) <span class="keyword">return</span> [];</span><br><span class="line">  <span class="keyword">return</span> quickSelect(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>, k - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSelect</span>(<span class="params">arr, lo, hi, k</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> j = partition(arr, lo, hi);</span><br><span class="line">  <span class="keyword">if</span> (j == k) <span class="keyword">return</span> arr[j];</span><br><span class="line">  <span class="keyword">return</span> j &gt; k ? quickSelect(arr, lo, j - <span class="number">1</span>, k) : quickSelect(arr, j + <span class="number">1</span>, hi, k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">arr, lo, hi</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> value = arr[lo];</span><br><span class="line">  <span class="keyword">let</span> i = lo, j = hi + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> (++i &lt;= hi &amp;&amp; arr[i] &gt; value);</span><br><span class="line">    <span class="keyword">while</span> (--j &gt;= i &amp;&amp; arr[j] &lt; value);</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= j) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">let</span> t = arr[i];</span><br><span class="line">    arr[i] = arr[j];</span><br><span class="line">    arr[j] = t;</span><br><span class="line">  &#125;</span><br><span class="line">  arr[lo] = arr[j];</span><br><span class="line">  arr[j] = value;</span><br><span class="line">  <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者使用小根堆，保证堆顶是第k小的元素</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">k</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findKThLargest</span>(<span class="params">arr, k</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (!k || !arr.length || k &gt; arr.length) &#123;</span><br><span class="line">      <span class="keyword">return</span> [];</span><br><span class="line">  &#125;</span><br><span class="line">  createHeap(arr, k);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = k; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="comment">// 当前值比最小的k个值中的最大值小</span></span><br><span class="line">    <span class="keyword">if</span> (arr[i] &lt; arr[<span class="number">0</span>]) &#123;</span><br><span class="line">        [arr[i], arr[<span class="number">0</span>]] = [arr[<span class="number">0</span>], arr[i]];</span><br><span class="line">        ajustHeap(arr, <span class="number">0</span>, k);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr[k - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 构建大顶堆</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">createHeap</span>(<span class="params">arr, length</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 从叶子节点向上进行调整</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="built_in">Math</span>.floor(length / <span class="number">2</span>) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        ajustHeap(arr, i, length);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 调整长度为length的堆中元素位置</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">ajustHeap</span>(<span class="params">arr, index, length</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span> * index + <span class="number">1</span>; i &lt; length; i = <span class="number">2</span> * i + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">1</span> &lt; length &amp;&amp; arr[i + <span class="number">1</span>] &gt; arr[i]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[index] &gt; arr[i]) &#123;</span><br><span class="line">            [arr[index], arr[i]] = [arr[i], arr[index]];</span><br><span class="line">            index = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="46-implement-once"><a href="#46-implement-once" class="headerlink" title="46. implement _.once()"></a>46. implement <code>_.once()</code></h3><p><a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#once">_.once(func)</a> is used to force a function to be called only once, later calls only returns the result of first call.</p>
<p>Can you implement your own <code>once()</code>?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> onced = once(func)</span><br><span class="line"></span><br><span class="line">onced(<span class="number">1</span>) </span><br><span class="line"><span class="comment">// 1, func called with 1</span></span><br><span class="line"></span><br><span class="line">onced(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 1, even 2 is passed, previous result is returned </span></span><br></pre></td></tr></table></figure>

<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-general-memoization-function">14. Implement a general memoization function - <code>memo()</code> </a></p>
<p>本质就是单例模式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Function&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">once</span>(<span class="params">func</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> instance = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> isExcuted = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isExcuted) &#123;</span><br><span class="line">      instance = func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">      isExcuted = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="47-reverse-a-linked-list"><a href="#47-reverse-a-linked-list" class="headerlink" title="47. reverse a linked list"></a>47. reverse a linked list</h3><p>Another basic algorithm even for Front End developers.</p>
<p>You are asked to <strong>reverse a linked list</strong>.</p>
<p>Suppose we have Node interface like this</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">   <span class="keyword">new</span>(val: <span class="built_in">number</span>, <span class="attr">next</span>: Node);</span><br><span class="line">   val: <span class="built_in">number</span></span><br><span class="line">   next: Node</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can then chain nodes together to create a linked list.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Three = <span class="keyword">new</span> Node(<span class="number">3</span>, <span class="literal">null</span>)</span><br><span class="line"><span class="keyword">const</span> Two = <span class="keyword">new</span> Node(<span class="number">2</span>, Three)</span><br><span class="line"><span class="keyword">const</span> One = <span class="keyword">new</span> Node(<span class="number">1</span>, Two)</span><br><span class="line"></span><br><span class="line"><span class="comment">//now we have  a linked list</span></span><br><span class="line"><span class="comment">// 1 → 2 → 3</span></span><br></pre></td></tr></table></figure>

<p>Now how can you reverse it to 3 → 2 → 1 ? you can modify the <code>next</code> property of each node, but not the <code>val</code>.</p>
<p><em>Follow up</em></p>
<p>Could you solve it with and without recursion?</p>
<p>常规反转链表</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * class Node &#123;</span></span><br><span class="line"><span class="comment"> *  new(val: number, next: Node);</span></span><br><span class="line"><span class="comment"> *    val: number</span></span><br><span class="line"><span class="comment"> *    next: Node</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Node&#125;</span> <span class="variable">list</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Node&#125;</span> </span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> reverseLinkedList = <span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// your code</span></span><br><span class="line">    <span class="keyword">let</span> pre = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> curr = list;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (curr) &#123;</span><br><span class="line">        <span class="keyword">const</span> next = curr.next;</span><br><span class="line">        curr.next = pre;</span><br><span class="line">        pre = curr;</span><br><span class="line">        curr = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="48-search-first-index-with-Binary-Search-possible-duplicate-array"><a href="#48-search-first-index-with-Binary-Search-possible-duplicate-array" class="headerlink" title="48. search first index with Binary Search(possible duplicate array)"></a>48. search first index with Binary Search(possible duplicate array)</h3><p>This is a variation of <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique)</a>.</p>
<p>Your are given a sorted ascending array of number, but <strong>might have duplicates</strong>, you are asked to return the <strong>first index</strong> of a target number.</p>
<p>If not found return -1.</p>
<p><em>note</em></p>
<p>Please don’t use <code>Array.prototype.indexOf()</code>, it is not our goal.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-last-index-with-Binary-Search-possible-duplicate-array">49. search last index with Binary Search(possible duplicate array)</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-element-right-before-target-with-Binary-Search-possible-duplicate-array">50. search element right before target with Binary Search(possible duplicate array)</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-element-right-after-target-with-Binary-Search-possible-duplicate-array">51. search element right after target with Binary Search(possible duplicate array)</a></p>
<p>leftbound函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span> - ascending array with duplicates</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">target</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firstIndex</span>(<span class="params">arr, target</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">    <span class="keyword">const</span> mid = left + <span class="built_in">Math</span>.floor((right - left) / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (arr[mid] &gt;= target) &#123;</span><br><span class="line">      right = mid - <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      left = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr[left] === target ? left : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="49-search-last-index-with-Binary-Search-possible-duplicate-array"><a href="#49-search-last-index-with-Binary-Search-possible-duplicate-array" class="headerlink" title="49. search last index with Binary Search(possible duplicate array)"></a>49. search last index with Binary Search(possible duplicate array)</h3><p>This is a variation of <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique)</a>.</p>
<p>Your are given a sorted ascending array of number, but <strong>might have duplicates</strong>, you are asked to return the <strong>last index</strong> of a target number.</p>
<p>If not found return -1.</p>
<p><em>note</em></p>
<p>Please don’t use <code>Array.prototype.lastIndexOf()</code>, it is not our goal.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-first-index-with-Binary-Search-duplicate-array">48. search first index with Binary Search(possible duplicate array) </a></p>
<p>类似的rightbound</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span> - ascending array with duplicates</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">target</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lastIndex</span>(<span class="params">arr, target</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">    <span class="keyword">const</span> mid = left + <span class="built_in">Math</span>.floor((right - left) / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (arr[mid] &lt;= target) &#123;</span><br><span class="line">      left = mid + <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      right = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr[right] === target ? right : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="50-search-element-right-before-target-with-Binary-Search-possible-duplicate-array"><a href="#50-search-element-right-before-target-with-Binary-Search-possible-duplicate-array" class="headerlink" title="50. search element right before target with Binary Search(possible duplicate array)"></a>50. search element right before target with Binary Search(possible duplicate array)</h3><p>This is a variation of <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique)</a>.</p>
<p>Your are given a sorted ascending array of number, but <strong>might have duplicates</strong>, you are asked to return the <strong>element right before first appearance</strong> of a target number.</p>
<p>If not found return <code>undefined</code>.</p>
<p><em>note</em></p>
<p>Please don’t use <code>Array.prototype.indexOf()</code>, it is not our goal.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-first-index-with-Binary-Search-duplicate-array">48. search first index with Binary Search(possible duplicate array) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-last-index-with-Binary-Search-possible-duplicate-array">49. search last index with Binary Search(possible duplicate array) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-element-right-after-target-with-Binary-Search-possible-duplicate-array">51. search element right after target with Binary Search(possible duplicate array)</a></p>
<p>使用了leftbound找到左边界，然后找到左边界左边的数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span> - ascending array with duplicates</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">target</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">elementBefore</span>(<span class="params">arr, target</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">    <span class="keyword">const</span> mid = left + <span class="built_in">Math</span>.floor((right - left) / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (arr[mid] &gt;= target) &#123;</span><br><span class="line">      right = mid - <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      left = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (left &gt; <span class="number">0</span> &amp;&amp; arr[left] === target) ? arr[left - <span class="number">1</span>] : <span class="literal">undefined</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="51-search-element-right-after-target-with-Binary-Search-possible-duplicate-array"><a href="#51-search-element-right-after-target-with-Binary-Search-possible-duplicate-array" class="headerlink" title="51. search element right after target with Binary Search(possible duplicate array)"></a>51. search element right after target with Binary Search(possible duplicate array)</h3><p>This is a variation of <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique)</a>.</p>
<p>Your are given a sorted ascending array of number, but <strong>might have duplicates</strong>, you are asked to return the <strong>element right after last appearance</strong> of a target number.</p>
<p>If not found return <code>undefined</code>.</p>
<p><em>note</em></p>
<p>Please don’t use <code>Array.prototype.lastIndexOf()</code>, it is not our goal.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Binary-Search-Unique">37. implement Binary Search (unique) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-first-index-with-Binary-Search-duplicate-array">48. search first index with Binary Search(possible duplicate array) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-last-index-with-Binary-Search-possible-duplicate-array">49. search last index with Binary Search(possible duplicate array) </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/search-element-right-before-target-with-Binary-Search-possible-duplicate-array">50. search element right before target with Binary Search(possible duplicate array) </a></p>
<p>使用了rightbound找到右边界，然后找到右边界右边的数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">arr</span></span> - ascending array with duplicates</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">target</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">elementAfter</span>(<span class="params">arr, target</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">    <span class="keyword">const</span> mid = left + <span class="built_in">Math</span>.floor((right - left) / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (arr[mid] &lt;= target) &#123;</span><br><span class="line">      left = mid + <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      right = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (right &lt; arr.length - <span class="number">1</span> &amp;&amp; arr[right] === target) ? arr[right + <span class="number">1</span>] : <span class="literal">undefined</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="52-create-a-middleware-system"><a href="#52-create-a-middleware-system" class="headerlink" title="52. create a middleware system"></a>52. create a middleware system</h3><p>Have you ever used <a target="_blank" rel="noopener" href="http://expressjs.com/en/guide/using-middleware.html#using-middleware">Express Middleware</a> before?</p>
<p>Middleware functions are functions with fixed interface that could be chained up like following two functions.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&#x27;/user/:id&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  next()</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  next(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;sth wrong&#x27;</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>You are asked to create simplified Middleware system:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Request = <span class="built_in">object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> NextFunc =  <span class="function">(<span class="params">error?: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MiddlewareFunc = </span><br><span class="line">  (req: Request, <span class="attr">next</span>: NextFunc) =&gt; <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ErrorHandler = </span><br><span class="line">  (error: <span class="built_in">Error</span>, <span class="attr">req</span>: Request, <span class="attr">next</span>: NextFunc) =&gt; <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Middleware</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">use</span>(<span class="params">func: MiddlewareFunc | ErrorHandler</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// do any async operations</span></span><br><span class="line">    <span class="comment">// call next() to trigger next function</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">start</span>(<span class="params">req: Request</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// trigger all functions with a req object</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now we can do something similar with Express</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> middleware = <span class="keyword">new</span> Middleware()</span><br><span class="line"></span><br><span class="line">middleware.use(<span class="function">(<span class="params">req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   req.a = <span class="number">1</span></span><br><span class="line">   next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">middleware.use(<span class="function">(<span class="params">req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   req.b = <span class="number">2</span></span><br><span class="line">   next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">middleware.use(<span class="function">(<span class="params">req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(req)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">middleware.start(&#123;&#125;)</span><br><span class="line"><span class="comment">// &#123;a: 1, b: 2&#125;</span></span><br></pre></td></tr></table></figure>

<p>Notice that <code>use()</code> could also accept an ErrorHandler which has 3 arguments. The error handler is triggered if <code>next()</code> is called with an extra argument or uncaught error happens, like following.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> middleware = <span class="keyword">new</span> Middleware()</span><br><span class="line"></span><br><span class="line"><span class="comment">// throw an error at first function</span></span><br><span class="line">middleware.use(<span class="function">(<span class="params">req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   req.a = <span class="number">1</span></span><br><span class="line">   <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;sth wrong&#x27;</span>) </span><br><span class="line">   <span class="comment">// or `next(new Error(&#x27;sth wrong&#x27;))`</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// since error occurs, this is skipped</span></span><br><span class="line">middleware.use(<span class="function">(<span class="params">req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   req.b = <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// since error occurs, this is skipped</span></span><br><span class="line">middleware.use(<span class="function">(<span class="params">req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(req)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// since error occurs, this is called</span></span><br><span class="line">middleware.use(<span class="function">(<span class="params">error, req, next</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(error)</span><br><span class="line">   <span class="built_in">console</span>.log(req)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">middleware.start(&#123;&#125;)</span><br><span class="line"><span class="comment">// Error: sth wrong</span></span><br><span class="line"><span class="comment">// &#123;a: 1&#125;</span></span><br></pre></td></tr></table></figure>

<p>直接调用中间件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Middleware</span> </span>&#123;</span><br><span class="line">  <span class="title">constructor</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.middlewareFuncs = [];</span><br><span class="line">    <span class="built_in">this</span>.middlewareFuncIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">this</span>.errorHandlers = [];</span><br><span class="line">    <span class="built_in">this</span>.errorHandlerIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">this</span>.next = <span class="built_in">this</span>.next.bind(<span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;MiddlewareFunc&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">use</span>(<span class="params">func</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (func.length === <span class="number">2</span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.middlewareFuncs.push(func);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (func.length === <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.errorHandlers.push(func);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;Request&#125;</span> <span class="variable">req</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">start</span>(<span class="params">req</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.req = req;</span><br><span class="line">    <span class="built_in">this</span>.next();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">next</span>(<span class="params">error</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> func;</span><br><span class="line">      <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        func = <span class="built_in">this</span>.errorHandlers[<span class="built_in">this</span>.errorHandlerIndex++];</span><br><span class="line">        func(error, <span class="built_in">this</span>.req, <span class="built_in">this</span>.next);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        func = <span class="built_in">this</span>.middlewareFuncs[<span class="built_in">this</span>.middlewareFuncIndex++];</span><br><span class="line">        func(<span class="built_in">this</span>.req, <span class="built_in">this</span>.next);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="keyword">const</span> errorHandler = <span class="built_in">this</span>.errorHandlers[<span class="built_in">this</span>.errorHandlerIndex++];</span><br><span class="line">      errorHandler(err, <span class="built_in">this</span>.req, <span class="built_in">this</span>.next);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="53-write-your-own-extends-in-es5"><a href="#53-write-your-own-extends-in-es5" class="headerlink" title="53. write your own extends in es5"></a>53. write your own <code>extends</code> in es5</h3><p>I believe you’ve used <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/extends">extends</a> keyword in you JavaScript programs before.</p>
<p>Could you implement a <code>myExtends()</code> function in ES5 to mimic the behavior of <code>extends</code>?</p>
<p><code>myExtends()</code> takes a SubType and SuperType, and return a new type.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> InheritedSubType = myExtends(SuperType, SubType)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> InheritedSubType()</span><br><span class="line"></span><br><span class="line"><span class="comment">// above should work (almost) the same as follows</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubType</span> <span class="keyword">extends</span> <span class="title">SuperType</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> SubType()</span><br></pre></td></tr></table></figure>

<p>To solve this problem, you need to fully understand what is <a target="_blank" rel="noopener" href="https://javascript.info/class-inheritance">Inheritance</a></p>
<p><em>note</em></p>
<p>Your code will be test against following SuperType and SubType</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">    <span class="built_in">this</span>.forSuper = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="built_in">this</span>.from = <span class="string">&#x27;super&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.superMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">SuperType.prototype.method = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">SuperType.staticSuper = <span class="string">&#x27;staticSuper&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">    <span class="built_in">this</span>.forSub = [<span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    <span class="built_in">this</span>.from = <span class="string">&#x27;sub&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SubType.prototype.subMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">SubType.prototype.method = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">SubType.staticSub = <span class="string">&#x27;staticSub&#x27;</span></span><br></pre></td></tr></table></figure>

<p>改变原型链</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myExtends = <span class="function">(<span class="params">SuperType, SubType</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title">constructor</span> = <span class="title">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="comment">// Call the original Constructors with the constructor</span></span><br><span class="line">    <span class="comment">// instance as their context</span></span><br><span class="line">    SuperType.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    SubType.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    <span class="built_in">Object</span>.setPrototypeOf(<span class="built_in">this</span>, SubType.prototype)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Object</span>.setPrototypeOf(SubType.prototype, SuperType.prototype);</span><br><span class="line">  <span class="built_in">Object</span>.setPrototypeOf(<span class="title">constructor</span>.<span class="title">prototype</span>, <span class="title">SubType</span>.<span class="title">prototype</span>);</span><br><span class="line">  <span class="comment">// Inherit static properties</span></span><br><span class="line">  <span class="built_in">Object</span>.setPrototypeOf(<span class="title">constructor</span>, <span class="title">SuperType</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title">constructor</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="54-flatten-Thunk"><a href="#54-flatten-Thunk" class="headerlink" title="54. flatten Thunk"></a>54. flatten Thunk</h3><p>Suppose we have a Callback type</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Callback = </span><br><span class="line">  (error: <span class="built_in">Error</span>, <span class="attr">result</span>: <span class="built_in">any</span> | Thunk) =&gt; <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>A Thunk is a function that take a Callback as parameter</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Thunk = <span class="function">(<span class="params">callback: Callback</span>) =&gt;</span> <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>Like following three thunks</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> func1 = <span class="function">(<span class="params">cb</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> cb(<span class="literal">null</span>, <span class="string">&#x27;ok&#x27;</span>), <span class="number">10</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> func2 = <span class="function">(<span class="params">cb</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> cb(<span class="literal">null</span>, func1), <span class="number">10</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> func3 = <span class="function">(<span class="params">cb</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> cb(<span class="literal">null</span>, func2), <span class="number">10</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>in above example, three functions are kind of chained up, func3 → func2 → func1, but it don’t work without some glue.</p>
<p>OK, now you are asked to implement a <code>flattenThunk()</code> which glue them up and returns a new thunk.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flattenThunk(func3)(<span class="function">(<span class="params">error, data</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data) <span class="comment">// &#x27;ok&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><em>note</em></p>
<p>Once error occurs, the rest uncalled functions should be skipped</p>
<p><a target="_blank" rel="noopener" href="https://github.com/kolodny/exercises/tree/master/flatten-thunk">Source for this </a></p>
<p>返回一个闭包</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Thunk&#125;</span> <span class="variable">thunk</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Thunk&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flattenThunk</span>(<span class="params">thunk</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> callbackWrapper = <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        callback(err);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        data(callbackWrapper);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback(err, data);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    thunk(callbackWrapper);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="55-highlight-keywords-in-HTML-string"><a href="#55-highlight-keywords-in-HTML-string" class="headerlink" title="55. highlight keywords in HTML string"></a>55. highlight keywords in HTML string</h3><p>Suppose you are implementing an auto-complete in search input.</p>
<p>When keywords are typed, you need to <strong>highlight the keywords</strong>, how would you do that?</p>
<p>To simplify things, you need to create a function <code>highlightKeywords(html:string, keywords: string[])</code>, which wraps the keywords in html string, with <code>&lt;em&gt;</code> tag.</p>
<p>Here is an example.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">highlightKeywords(</span><br><span class="line">  <span class="string">&#x27;Hello FrontEnd Lovers&#x27;</span>, </span><br><span class="line">  [<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;Front&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#x27;&lt;em&gt;Hello&lt;/em&gt; &lt;em&gt;Front&lt;/em&gt;End Lovers&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Pay attention to the overlapping and adjacent case. You should use the least tags as possible.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">highlightKeywords(</span><br><span class="line">  <span class="string">&#x27;Hello FrontEnd Lovers&#x27;</span>, </span><br><span class="line">  [<span class="string">&#x27;Front&#x27;</span>, <span class="string">&#x27;End&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#x27;Hello &lt;em&gt;FrontEnd&lt;/em&gt; Lovers&#x27;</span></span><br><span class="line"></span><br><span class="line">highlightKeywords(</span><br><span class="line">  <span class="string">&#x27;Hello FrontEnd Lovers&#x27;</span>, </span><br><span class="line">  [<span class="string">&#x27;Front&#x27;</span>, <span class="string">&#x27;FrontEnd&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#x27;Hello &lt;em&gt;FrontEnd&lt;/em&gt; Lovers&#x27;</span></span><br></pre></td></tr></table></figure>

<p>note that <code>space</code> should not be included.</p>
<p>分隔单词，进行操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">html</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string[]&#125;</span> <span class="variable">keywords</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">highlightKeywords</span>(<span class="params">html, keywords</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(keywords.join(<span class="string">&#x27;|&#x27;</span>), <span class="string">&#x27;gi&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> html.split(<span class="string">&#x27; &#x27;</span>).map(<span class="function">(<span class="params">word</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (keywords.includes(word)) <span class="keyword">return</span> <span class="string">`&lt;em&gt;<span class="subst">$&#123;word&#125;</span>&lt;/em&gt;`</span>;</span><br><span class="line">    <span class="keyword">return</span> word.replace(regexp, <span class="function">(<span class="params">w</span>) =&gt;</span> <span class="string">`&lt;em&gt;<span class="subst">$&#123;w&#125;</span>&lt;/em&gt;`</span>).replace(<span class="string">&#x27;&lt;/em&gt;&lt;em&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;).join(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="56-call-APIs-with-pagination"><a href="#56-call-APIs-with-pagination" class="headerlink" title="56. call APIs with pagination"></a>56. call APIs with pagination</h3><p>Have you ever met some APIs with pagination, and needed to recursively fetch them based on response of previous request ?</p>
<p>Suppose we have a <code>/list</code> API, which returns an array <code>items</code>.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fetchList is provided for you</span></span><br><span class="line"><span class="keyword">const</span> fetchList = <span class="function">(<span class="params">since?: <span class="built_in">number</span></span>) =&gt;</span> </span><br><span class="line">  <span class="built_in">Promise</span>&lt;&#123;<span class="attr">items</span>: <span class="built_in">Array</span>&lt;&#123;<span class="attr">id</span>: <span class="built_in">number</span>&#125;&gt;&#125;&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>for initial request, we just fetch <code>fetchList</code>. and get the last item id from response.</li>
<li>for next page, we need to call <code>fetchList(lastItemId)</code>.</li>
<li>repeat above process.</li>
</ol>
<p>The <code>/list</code> API only gives us 5 items at a time, with server-side filtering, it might be less than 5. But if none returned, it means nothing to fetch any more and we should stop.</p>
<p>You are asked to create a function that could return arbitrary amount of items.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetchListWithAmount = (amount: <span class="built_in">number</span> = <span class="number">5</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<p><em>note</em></p>
<p>You can achieve this by regular loop, even fancier solutions with <a target="_blank" rel="noopener" href="https://javascript.info/async-iterators-generator">async iterators or async generators</a>. You should try them all.</p>
<p>记录顺序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fetchList is provided for you</span></span><br><span class="line"><span class="comment">// const fetchList = (since?: number) =&gt; </span></span><br><span class="line"><span class="comment">//   Promise&lt;&#123;items: Array&lt;&#123;id: number&#125;&gt;&#125;&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// you can change this to generator function if you want</span></span><br><span class="line"><span class="keyword">const</span> fetchListWithAmount = <span class="keyword">async</span> (amount = <span class="number">5</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> items = [];</span><br><span class="line">  <span class="keyword">let</span> lastItemId = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (items.length &lt;= amount) &#123;</span><br><span class="line">    <span class="keyword">const</span> response = lastItemId ? <span class="keyword">await</span> fetchList(lastItemId) : <span class="keyword">await</span> fetchList();</span><br><span class="line">    <span class="keyword">if</span> (!response || !response.items.length) &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    items.push(...response.items);</span><br><span class="line">    lastItemId = items[items.length - <span class="number">1</span>].id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> items.slice(<span class="number">0</span>, amount);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="57-create-an-Observable"><a href="#57-create-an-Observable" class="headerlink" title="57. create an Observable"></a>57. create an Observable</h3><p>Have you ever used <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/guide/overview">RxJS</a> before? The most important concept in it is <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/guide/observable">Observable</a> and <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/guide/observer">Observer</a>.</p>
<p>Observable defines how values are delivered to Observer. Observer is just a set of callbacks.</p>
<p>Let’s look at the code.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observer = &#123;</span><br><span class="line">  next: <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">&#x27;we got a value&#x27;</span>, value)</span><br><span class="line">  &#125;,</span><br><span class="line">  error: <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;we got an error&#x27;</span>, error)</span><br><span class="line">  &#125;,</span><br><span class="line">  complete: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ok, no more values&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Above is an Observer which is pretty clear about what it is doing.</p>
<p>Then we could attach this Observer to some Observable. Observable feeds this observer with values or errors.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function">(<span class="params">subscriber</span>)=&gt;</span> &#123;</span><br><span class="line">  subscriber.next(<span class="number">1</span>)</span><br><span class="line">  subscriber.next(<span class="number">2</span>)</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    subscriber.next(<span class="number">3</span>)</span><br><span class="line">    subscriber.next(<span class="number">4</span>)</span><br><span class="line">    subscriber.complete()</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>The code plainly says when is a subscriber is attached,</p>
<ol>
<li>subscriber is fed with a value <code>1</code></li>
<li>subscriber is then fed with a value <code>2</code></li>
<li>wait 100 ms</li>
<li>subscriber is fed with <code>3</code></li>
<li>subscriber is fed with <code>4</code></li>
<li>no more values for subscriber</li>
</ol>
<p>Now if we attach above <code>observer</code> to <code>observable</code>, <code>next</code> and <code>complete</code> of subscriber are called in order.(be aware that there is a delay between 2 and 3)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sub = observable.subscribe(subscriber)</span><br><span class="line"><span class="comment">// we got a value 1</span></span><br><span class="line"><span class="comment">// we got a value 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// we got a value 3</span></span><br><span class="line"><span class="comment">// we got a value 4</span></span><br><span class="line"><span class="comment">// ok, no more values</span></span><br></pre></td></tr></table></figure>

<p>Notice <code>subscribe()</code> return a <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/guide/subscription">Subscription</a> which could be used to stop listening to the value delivery.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sub = observable.subscribe(subscriber)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ok we only subscribe for 100ms</span></span><br><span class="line">  sub.unsubscribe()</span><br><span class="line">&#125;, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<p>So this is the basic idea of Observable and Observer. There will be a few more interesting follow-up problems.</p>
<p><strong>Now you are asked to implement a basic Observable class</strong>, which makes above possible.</p>
<p>Some extra requirements are listed here.</p>
<ol>
<li><code>error</code> and <code>complete</code> can only be delivered once, <code>next/error/complete</code> after <code>error/complete</code> should not work</li>
<li>for a subscriber object, <code>next/error/complete</code> callback are all optional. if a function is passed as observer, it is treated as <code>next</code>.</li>
<li>should support multiple subscription</li>
</ol>
<p><em>Further Reading</em></p>
<p><a target="_blank" rel="noopener" href="https://github.com/tc39/proposal-observable">https://github.com/tc39/proposal-observable</a></p>
<p><a target="_blank" rel="noopener" href="https://www.glassdoor.com/Interview/Signed-NDA-But-phone-interview-questions-were-same-as-mentioned-many-times-here-flatten-array-optimize-a-function-imple-QTN_2512492.htm">Source for this </a></p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-from">70. implement Observable.from()</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-Subject">71. implement Observable Subject</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">setup</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.setup = setup;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="function"><span class="title">subscribe</span>(<span class="params">subscriber</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> originalNext = <span class="keyword">typeof</span> subscriber === <span class="string">&#x27;function&#x27;</span> ? subscriber : subscriber.next;</span><br><span class="line">    <span class="keyword">const</span> originalError = subscriber.error;</span><br><span class="line">    <span class="keyword">const</span> originalComplete = subscriber.complete;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> isUnsubscribed = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    subscriber.next = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (isUnsubscribed) &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> originalNext === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        originalNext(value);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    subscriber.error = <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (isUnsubscribed) &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      isUnsubscribed = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> originalError === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        originalError(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    subscriber.complete = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (isUnsubscribed) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      isUnsubscribed = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> originalComplete === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        originalComplete();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.setup(subscriber);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="function"><span class="title">unsubscribe</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        isUnsubscribed = <span class="literal">true</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="58-get-DOM-tree-height"><a href="#58-get-DOM-tree-height" class="headerlink" title="58. get DOM tree height"></a>58. get DOM tree height</h3><p>Height of a tree is the maximum depth from root node. Empty root node have a height of 0.</p>
<p>If given DOM tree, can you create a function to get the height of it?</p>
<p>For the DOM tree below, we have a height of 4.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>World!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Can you solve this both recursively and iteratively?</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/find-corresponding-node-in-two-identical-DOM-tree">19. find corresponding node in two identical DOM tree </a></p>
<p>使用递归层次DFS</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement | null&#125;</span> <span class="variable">tree</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHeight</span>(<span class="params">tree</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (tree === <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> maxHeight = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// Use .children instead of .childNodes to ignore TextNodes.</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> child <span class="keyword">of</span> tree.children) &#123;</span><br><span class="line">    maxHeight = <span class="built_in">Math</span>.max(maxHeight, getHeight(child));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> maxHeight + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用队列BFS</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement | null&#125;</span> <span class="variable">tree</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHeight</span>(<span class="params">tree</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (tree === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> maxHeight = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> queue = [[tree, <span class="number">1</span>]];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (queue.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [el, height] = queue.shift();</span><br><span class="line">    maxHeight = <span class="built_in">Math</span>.max(height, maxHeight);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> child <span class="keyword">of</span> el.children) &#123;</span><br><span class="line">      queue.push([child, height + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> maxHeight;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="59-create-a-browser-history"><a href="#59-create-a-browser-history" class="headerlink" title="59. create a browser history"></a>59. create a browser history</h3><p>I believe you are very familiar about your browser you are currently visiting <a target="_blank" rel="noopener" href="https://bigfrontend.dev/">https://bigfrontend.dev</a> with.</p>
<p>The common actions relating to history are:</p>
<ol>
<li><code>new BrowserHistory()</code> - when you open a new tab, it is set with an empty history</li>
<li><code>goBack()</code> - go to last entry, notice the entries are kept so that <code>forward()</code> could get us back</li>
<li><code>forward()</code> - go to next visited entry</li>
<li><code>visit()</code> - when you enter a new address or click a link, this adds a new entry but truncate the entries which we could <code>forward()</code> to.</li>
</ol>
<p>Say we start a new tab, this is the empty history.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ ] </span><br></pre></td></tr></table></figure>

<p>Then visit url A, B, C in turn.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ A, B, C]</span><br><span class="line">        ↑</span><br></pre></td></tr></table></figure>

<p>We are currently at C, we could <code>goBack()</code> to B, then to A</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ A, B, C]</span><br><span class="line">  ↑          </span><br></pre></td></tr></table></figure>

<p><code>forward()</code> get us to B</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ A, B, C]</span><br><span class="line">     ↑          </span><br></pre></td></tr></table></figure>

<p>Now if we visit a new url D, since we are currently at B, C is truncated.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ A, B, D]</span><br><span class="line">        ↑</span><br></pre></td></tr></table></figure>

<p>You are asked to implement a <code>BrowserHistory</code> class to mimic the behavior.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BrowserHistory</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">url</span></span></span></span><br><span class="line"><span class="comment">   * if url is set, it means new tab with url</span></span><br><span class="line"><span class="comment">   * otherwise, it is empty new tab</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">url</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// Store the url, since the method `goBack()` should</span></span><br><span class="line">    <span class="comment">// return the initial url if it is out of bounds.</span></span><br><span class="line">    <span class="comment">/** For instance,</span></span><br><span class="line"><span class="comment">     *  const bh = new BrowserHistory(&#x27;X&#x27;)</span></span><br><span class="line"><span class="comment">     *  bh.visit(&#x27;A&#x27;)</span></span><br><span class="line"><span class="comment">     *  bh.goBack()</span></span><br><span class="line"><span class="comment">     *  bh.goBack()</span></span><br><span class="line"><span class="comment">     *  console.log(bh.current); // should be be &#x27;X&#x27; rather than undefined.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">this</span>.initialUrl = url;</span><br><span class="line">    <span class="built_in">this</span>.urls = url ? [url] : [];</span><br><span class="line">    <span class="built_in">this</span>.currentIndex = <span class="built_in">this</span>.urls.length - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123; string &#125;</span> <span class="variable">url</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="title">visit</span>(<span class="params">url</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.currentIndex++;</span><br><span class="line">    <span class="built_in">this</span>.urls[<span class="built_in">this</span>.currentIndex] = url;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return <span class="type">&#123;string&#125;</span> </span>current url</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">current</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.currentIndex &gt;= <span class="number">0</span> ? <span class="built_in">this</span>.urls[<span class="built_in">this</span>.currentIndex] : <span class="built_in">this</span>.initialUrl;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// go to previous entry</span></span><br><span class="line">  <span class="function"><span class="title">goBack</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.currentIndex--;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// go to next visited url</span></span><br><span class="line">  <span class="function"><span class="title">forward</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.currentIndex = <span class="built_in">Math</span>.min(<span class="built_in">this</span>.urls.length - <span class="number">1</span>, <span class="built_in">this</span>.currentIndex + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="60-create-your-own-new-operator"><a href="#60-create-your-own-new-operator" class="headerlink" title="60. create your own new operator"></a>60. create your own <code>new</code> operator</h3><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new"><code>new</code> operator</a> is used to create new instance objects.</p>
<p>Do you know exactly what <code>new</code> does?</p>
<p>You are asked to implement <code>myNew()</code>, which should return an object just as what <code>new</code> does but without using <code>new</code>.</p>
<p>Pay attention to the return type of constructor.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">constructor</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any[]&#125;</span> <span class="variable">args</span></span> - argument passed to the constructor</span></span><br><span class="line"><span class="comment"> * `myNew(constructor, ...args)` should return the same as `new constructor(...args)`</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> myNew = <span class="function">(<span class="params">constructor, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="comment">// The `Object.create()` method creates a new empty object, using the</span></span><br><span class="line">  <span class="comment">// specified object as the prototype of the newly created object.</span></span><br><span class="line">  <span class="keyword">const</span> obj = <span class="built_in">Object</span>.create(<span class="title">constructor</span>.<span class="title">prototype</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The `Object.create()` method creates a new empty object, using the</span></span><br><span class="line">  <span class="comment">// specified object as the prototype of the newly created object.</span></span><br><span class="line">  <span class="keyword">const</span> returnValue = <span class="title">constructor</span>.<span class="title">apply</span>(<span class="params">obj, args</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// If returnValue is an object, return returnValue, otherwise return obj.</span></span><br><span class="line">  <span class="comment">// Usually, constructors do not have return statement. The new operator</span></span><br><span class="line">  <span class="comment">// creates an object, assign it to this, and automatically returns that</span></span><br><span class="line">  <span class="comment">// object as a result. If a constructor has return statement and the return</span></span><br><span class="line">  <span class="comment">// value is an object, the object is returned instead of the newly created</span></span><br><span class="line">  <span class="comment">// object, otherwise the return value is ignored.</span></span><br><span class="line">  <span class="keyword">return</span> returnValue <span class="keyword">instanceof</span> <span class="built_in">Object</span> ? returnValue : obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="61-create-your-own-Function-prototype-call"><a href="#61-create-your-own-Function-prototype-call" class="headerlink" title="61. create your own Function.prototype.call"></a>61. create your own <code>Function.prototype.call</code></h3><p><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/#sec-function.prototype.call">Function.prototype.call</a> is very useful when we want to alter the <code>this</code> of a function.</p>
<p>Can you implement your own <code>myCall</code>, which returns the same result as <code>Function.prototype.call</code>?</p>
<p>For the <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/#sec-function.prototype.call">newest ECMAScript spec</a>, <code>thisArg</code> are not transformed. And not replaced with window in <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">Strict Mode</a>.</p>
<p>Your implementation should follow above spec and do what <em>non</em> Strict Mode does.</p>
<p><code>Function.prototype.cal/apply/bind</code> and <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/apply">Reflect.apply</a> should not be used.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.mycall = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="comment">// thisArg can be null or defined.</span></span><br><span class="line">  thisArg = thisArg || <span class="built_in">window</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Transform primitive value into object, so that we can add property.</span></span><br><span class="line">  thisArg = <span class="built_in">Object</span>(thisArg);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create a unique property name.</span></span><br><span class="line">  <span class="keyword">const</span> fn = <span class="built_in">Symbol</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Assign the function that has to be called to the unique property.</span></span><br><span class="line">  thisArg[fn] = <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Call the function as a method to get the correct context.</span></span><br><span class="line">  <span class="keyword">const</span> returnValue = thisArg[fn](...args);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Delete the unique property so that the original thisArg is not affected.</span></span><br><span class="line">  <span class="keyword">delete</span> thisArg[fn];</span><br><span class="line">  <span class="keyword">return</span> returnValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="62-implement-BigInt-addition"><a href="#62-implement-BigInt-addition" class="headerlink" title="62. implement BigInt addition"></a>62. implement BigInt addition</h3><p>Luckily we have <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt">BigInt</a> in JavaScript so handle big numbers.</p>
<p>What if we need to do it by ourselves for older browsers?</p>
<p>You are asked to implement a string addition function, <strong>with all non-negative integers in string</strong>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="string">&#x27;999999999999999999&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">// &#x27;1000000000000000000&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Don’t use BigInt directly, it is not our goal here.</p>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-BigInt-subtraction">75. implement BigInt subtraction</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-BigInt-addition-with-sign">76. implement BigInt addition with sign</a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-BigInt-subtraction-with-sign">77. implement BigInt subtraction with sign</a></p>
<p>双指针</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">num1</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">num2</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Use two pointers to keep track of the digit in the strings,</span></span><br><span class="line">  <span class="comment">// set both pointers to the end of the strings.</span></span><br><span class="line">  <span class="keyword">let</span> i = num1.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> j = num2.length - <span class="number">1</span>;</span><br><span class="line">  <span class="comment">// Keep track of the carry.</span></span><br><span class="line">  <span class="keyword">let</span> carry = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Iterate through both strings backwards,</span></span><br><span class="line">  <span class="comment">// until the beginning of both strings is reached and there</span></span><br><span class="line">  <span class="comment">// is no carry that needs to add to the result.</span></span><br><span class="line">  <span class="keyword">while</span> (i &gt;= <span class="number">0</span> || j &gt;= <span class="number">0</span> || carry &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// Get digits at current position in both strings.</span></span><br><span class="line">    <span class="comment">// If undefined, set to zero.</span></span><br><span class="line">    <span class="keyword">const</span> digit1 = <span class="built_in">Number</span>(num1[i] || <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> digit2 = <span class="built_in">Number</span>(num2[j] || <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// Add both digits and previous carry.</span></span><br><span class="line">    <span class="keyword">let</span> sum = digit1 + digit2 + carry;</span><br><span class="line">    <span class="comment">// If the sum &quot;overflows&quot;, bring over the carry to the next iteration.</span></span><br><span class="line">    carry = sum &gt;= <span class="number">10</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// Get the ones digit of the sum.</span></span><br><span class="line">    sum = sum % <span class="number">10</span>;</span><br><span class="line">    <span class="comment">// Add the ones digit to the beginning of the result.</span></span><br><span class="line">    result = <span class="built_in">String</span>(sum) + result;</span><br><span class="line">    i--;</span><br><span class="line">    j--;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="63-create-cloneDeep"><a href="#63-create-cloneDeep" class="headerlink" title="63. create _.cloneDeep()"></a>63. create <code>_.cloneDeep()</code></h3><p><code>Object.assign()</code> could be used to do shallow copy, while for recursive deep copy, <a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#cloneDeep">_.cloneDeep</a> could be very useful.</p>
<p>Can you create your own <code>_.cloneDeep()</code>?</p>
<p>The lodash implementation actually covers a lot of data types, for simplicity, your code just need to cover</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Primitive_values">primitive types</a> and their wrapper Object</li>
<li>Plain Objects (Object literal) with all enumerable properties</li>
<li>Array</li>
</ol>
<p>处理循环引用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use WeakMap that stores cloned results to handle circular reference.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneDeep</span>(<span class="params">data, map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (data === <span class="literal">null</span> || <span class="keyword">typeof</span> data !== <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// If the source object is already in the WeakMap,</span></span><br><span class="line">  <span class="comment">// its corresponding copy is returned instead of recursing</span></span><br><span class="line">  <span class="comment">// further.</span></span><br><span class="line">  <span class="keyword">if</span> (map.has(data)) &#123;</span><br><span class="line">    <span class="keyword">return</span> map.get(data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> res = <span class="built_in">Array</span>.isArray(data) ? [] : &#123;&#125;;</span><br><span class="line">  <span class="comment">// Store the source object and its clone in the WeakMap.</span></span><br><span class="line">  map.set(data, res);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> keys = [</span><br><span class="line">    ...Object.getOwnPropertyNames(data),</span><br><span class="line">    ...Object.getOwnPropertySymbols(data),</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> keys) &#123;</span><br><span class="line">    res[key] = cloneDeep()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="64-auto-retry-Promise-on-rejection"><a href="#64-auto-retry-Promise-on-rejection" class="headerlink" title="64. auto-retry Promise on rejection"></a>64. auto-retry Promise on rejection</h3><p>For a web application, fetching API data is a common task.</p>
<p>But the API calls might fail because of Network problems. Usually we could show a screen for Network Error and ask users to retry.</p>
<p>One approach to handle this is <strong>auto retry when network error occurs</strong>.</p>
<p>You are asked to create a <code>fetchWithAutoRetry(fetcher, count)</code>, which automatically fetch again when error happens, until the maximum count is met.</p>
<p>For the problem here, there is no need to detect network error, you can just retry on all promise rejections.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;() =&gt; Promise&lt;any&gt;&#125;</span> <span class="variable">fetcher</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">maximumRetryCount</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Promise&lt;any&gt;&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchWithAutoRetry</span>(<span class="params">fetcher, maximumRetryCount</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> retry = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fetcher()</span><br><span class="line">        .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (maximumRetryCount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            maximumRetryCount--;</span><br><span class="line">            retry();</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            reject(error);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    retry();</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="65-add-comma-to-number"><a href="#65-add-comma-to-number" class="headerlink" title="65. add comma to number"></a>65. add comma to number</h3><p>Given a number, please create a function to add commas as thousand separators.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">addComma(<span class="number">1</span>) <span class="comment">// &#x27;1&#x27;</span></span><br><span class="line">addComma(<span class="number">1000</span>) <span class="comment">// &#x27;1,000&#x27;</span></span><br><span class="line">addComma(-<span class="number">12345678</span>) <span class="comment">// &#x27;-12,345,678&#x27;</span></span><br><span class="line">addComma(<span class="number">12345678.12345</span>) <span class="comment">// &#x27;12,345,678.12345&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Input are all valid numbers.</p>
<p>正则表达式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">num</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addComma</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> str = <span class="built_in">Number</span>(num).toString();</span><br><span class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/(?&lt;!\d+\.\d*)(\d)(?=(\d&#123;3&#125;)+(\.\d+)?$)/g</span>, <span class="string">&#x27;$1,&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自带的toLocaleString</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">num</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addComma</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  num = <span class="built_in">Number</span>(num).toString().split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  <span class="keyword">let</span> res = <span class="built_in">Number</span>(num[<span class="number">0</span>]).toLocaleString();</span><br><span class="line">  <span class="keyword">if</span> (num[<span class="number">1</span>]) &#123;</span><br><span class="line">      res += <span class="string">&#x27;.&#x27;</span> + num[<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自带字符串函数操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">num</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addComma</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 按小数点分割</span></span><br><span class="line">  num = <span class="built_in">Number</span>(num).toString().split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  <span class="comment">// 将整数部分转换成字符数组并且倒序排列</span></span><br><span class="line">  <span class="keyword">let</span> arr = num[<span class="number">0</span>].split(<span class="string">&#x27;&#x27;</span>).reverse();</span><br><span class="line">  <span class="comment">// 存放添加&#x27;,&#x27;的整数</span></span><br><span class="line">  <span class="keyword">let</span> res = [arr[<span class="number">0</span>]];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">      <span class="comment">// 添加分隔符</span></span><br><span class="line">      <span class="keyword">if</span> (i % <span class="number">3</span> === <span class="number">0</span>) res.push(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">      res.push(arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 再次将整数部分倒序成为正确的顺序，并拼接成字符串</span></span><br><span class="line">  res = res.reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="comment">// 如果有小数的话添加小数部分</span></span><br><span class="line">  <span class="keyword">if</span> (num[<span class="number">1</span>]) &#123;</span><br><span class="line">      res += <span class="string">&#x27;.&#x27;</span> + num[<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="66-remove-duplicates-from-an-array"><a href="#66-remove-duplicates-from-an-array" class="headerlink" title="66. remove duplicates from an array"></a>66. remove duplicates from an array</h3><p>Given an array containing all kinds of data, please implement a function <code>deduplicate()</code> to remove the duplicates.</p>
<p>You should modify the array in place. Order doesn’t matter.</p>
<blockquote>
<p>What is time &amp; space cost of your approach?</p>
</blockquote>
<p>利用set</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any[]&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deduplicate</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="keyword">new</span> <span class="built_in">Set</span>(arr);</span><br><span class="line">  arr.splice(<span class="number">0</span>);</span><br><span class="line">  arr.push(...res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还有别的方法</p>
<h3 id="67-create-your-own-Promise"><a href="#67-create-your-own-Promise" class="headerlink" title="67. create your own Promise"></a>67. create your own Promise</h3><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> is widely used nowadays, hard to think how we handled <a target="_blank" rel="noopener" href="http://callbackhell.com/">Callback Hell</a> in the old times.</p>
<p>Can you implement a <code>MyPromise</code> Class by yourself?</p>
<p>At least it should match following requirements</p>
<ol>
<li>new promise: <code>new MyPromise((resolve, reject) =&gt; &#123;&#125;)</code></li>
<li>chaining : <code>MyPromise.prototype.then()</code> <em><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then">then handlers</a> should be called asynchronously</em></li>
<li>rejection handler: <code>MyPromise.prototype.catch()</code></li>
<li>static methods: <code>MyPromise.resolve()</code>, <code>MyPromise.reject()</code>.</li>
</ol>
<p>This is a challenging problem. Recommend you read about Promise thoroughly first.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPromise</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">executor</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// your code here</span></span><br><span class="line">    <span class="built_in">this</span>.state = <span class="string">&#x27;pending&#x27;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      executor(<span class="built_in">this</span>._resolve.bind(<span class="built_in">this</span>), <span class="built_in">this</span>._reject.bind(<span class="built_in">this</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="built_in">this</span>._reject(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="function"><span class="title">_resolve</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.state !== <span class="string">&#x27;pending&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.state = <span class="string">&#x27;fulfilled&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.result = value;</span><br><span class="line"></span><br><span class="line">    queueMicrotask(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.onFulfilled === <span class="literal">undefined</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> returnValue = <span class="built_in">this</span>.onFulfilled(<span class="built_in">this</span>.result);</span><br><span class="line">        <span class="keyword">const</span> isReturnValuePromise = returnValue <span class="keyword">instanceof</span> MyPromise;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!isReturnValuePromise) &#123;</span><br><span class="line">          <span class="built_in">this</span>.thenPromiseResolve(returnValue);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          returnValue.then(<span class="built_in">this</span>.thenPromiseResolve, <span class="built_in">this</span>.thenPromiseReject);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">this</span>.thenPromiseReject(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">_reject</span>(<span class="params">error</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.state !== <span class="string">&#x27;pending&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.state = <span class="string">&#x27;rejected&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.result = error;</span><br><span class="line"></span><br><span class="line">    queueMicrotask(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.onRejected === <span class="literal">undefined</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> returnValue = <span class="built_in">this</span>.onRejected(<span class="built_in">this</span>.result);</span><br><span class="line">        <span class="keyword">const</span> isReturnValuePromise = returnValue <span class="keyword">instanceof</span> MyPromise;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!isReturnValuePromise) &#123;</span><br><span class="line">          <span class="built_in">this</span>.thenPromiseResolve(returnValue);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          returnValue.then(<span class="built_in">this</span>.thenPromiseResolve, <span class="built_in">this</span>.thenPromiseReject);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">this</span>.thenPromiseReject(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">then</span>(<span class="params">onFulfilled, onRejected</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// your code here</span></span><br><span class="line">    <span class="keyword">const</span> isOnFulfilledFunction = <span class="keyword">typeof</span> onFulfilled === <span class="string">&#x27;function&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.onFulfilled = isOnFulfilledFunction ? onFulfilled : <span class="function">(<span class="params">value</span>) =&gt;</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> isOnRejectedFunction = <span class="keyword">typeof</span> onRejected === <span class="string">&#x27;function&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.onRejected = isOnRejectedFunction</span><br><span class="line">      ? onRejected</span><br><span class="line">      : <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> error;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// Register `resolve` and `reject`, so that we can</span></span><br><span class="line">      <span class="comment">// resolve or reject this promise in `_resolve`</span></span><br><span class="line">      <span class="comment">// or `_reject`.</span></span><br><span class="line">      <span class="built_in">this</span>.thenPromiseResolve = resolve;</span><br><span class="line">      <span class="built_in">this</span>.thenPromiseReject = reject;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">catch</span>(onRejected) &#123;</span><br><span class="line">    <span class="comment">// your code here</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.then(<span class="literal">undefined</span>, onRejected);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">resolve</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// your code here</span></span><br><span class="line">    <span class="keyword">const</span> isValuePromise = value <span class="keyword">instanceof</span> MyPromise;</span><br><span class="line">    <span class="keyword">if</span> (isValuePromise) &#123;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">      resolve(value);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">reject</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// your code here</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">_, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      reject(value);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="68-get-DOM-tags"><a href="#68-get-DOM-tags" class="headerlink" title="68. get DOM tags"></a>68. get DOM tags</h3><p>Given a DOM tree, please return all the tag names it has.</p>
<p>Your function should return a unique array of tags names in lowercase, order doesn’t matter.</p>
<p>遍历节点，用set保存</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement&#125;</span> <span class="variable">tree</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;string[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTags</span>(<span class="params">tree</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">const</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> stack = [tree];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (stack.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> top = stack.pop();</span><br><span class="line">    set.add(top.tagName.toLowerCase());</span><br><span class="line">    stack.push(...top.children);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [...set];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="69-implement-deep-equal-isEqual"><a href="#69-implement-deep-equal-isEqual" class="headerlink" title="69. implement deep equal _.isEqual()"></a>69. implement deep equal <code>_.isEqual()</code></h3><p><a target="_blank" rel="noopener" href="https://lodash.com/docs/4.17.15#isEqual">_.isEqual</a> is useful when you want to compare complex data types by value not the reference.</p>
<p>Can you implement your own version of deep equal <code>isEqual</code>? The lodash version covers a lot of data types. In this problem, you are asked to support :</p>
<ol>
<li>primitives</li>
<li>plain objects (object literals)</li>
<li>array</li>
</ol>
<p>Objects are compared by their own, not inherited, enumerable properties</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123;<span class="attr">a</span>: <span class="string">&#x27;bfe&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">const</span> b = &#123;<span class="attr">a</span>: <span class="string">&#x27;bfe&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">isEqual(a, b) <span class="comment">// true</span></span><br><span class="line">a === b <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> c = [<span class="number">1</span>, a, <span class="string">&#x27;4&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> d = [<span class="number">1</span>, b, <span class="string">&#x27;4&#x27;</span>]</span><br><span class="line"></span><br><span class="line">isEqual(c, d) <span class="comment">// true</span></span><br><span class="line">c === d <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>Lodash implementation has some strange behaviors. (<a target="_blank" rel="noopener" href="https://github.com/lodash/lodash/issues/2463">github issue</a>, like following code</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123;&#125;</span><br><span class="line">a.self = a</span><br><span class="line"><span class="keyword">const</span> b = &#123;<span class="attr">self</span>: a&#125;</span><br><span class="line"><span class="keyword">const</span> c = &#123;&#125;</span><br><span class="line">c.self = c</span><br><span class="line"><span class="keyword">const</span> d = &#123;<span class="attr">self</span>: &#123;<span class="attr">self</span>: a&#125;&#125;</span><br><span class="line"><span class="keyword">const</span> e = &#123;<span class="attr">self</span>: &#123;<span class="attr">self</span>: b&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><code>lodash.isEqual</code> gives us following result. Notice there is a case that resulting in <code>false</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// result from lodash implementation</span></span><br><span class="line">_.isEqual(a, b) <span class="comment">// true</span></span><br><span class="line">_.isEqual(a, c) <span class="comment">// true</span></span><br><span class="line">_.isEqual(a, d) <span class="comment">// true</span></span><br><span class="line">_.isEqual(a, e) <span class="comment">// true</span></span><br><span class="line">_.isEqual(b, c) <span class="comment">// true</span></span><br><span class="line">_.isEqual(b, d) <span class="comment">// true</span></span><br><span class="line">_.isEqual(b, e) <span class="comment">// false</span></span><br><span class="line">_.isEqual(c, d) <span class="comment">// true</span></span><br><span class="line">_.isEqual(c, e) <span class="comment">// true</span></span><br><span class="line">_.isEqual(d, e) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>Setting aside the performance concerns mentioned by lodash, <strong>your implement should not have above problem</strong>, which means above all returns <strong>true</strong> and call stack should not exceed the maximum.</p>
<p>深度遍历，找到最后的结果</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">a</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">b</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEqual</span>(<span class="params">a, b, map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">if</span> (a === <span class="literal">null</span> || b === <span class="literal">null</span>) <span class="keyword">return</span> a === b;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> a !== <span class="string">&#x27;object&#x27;</span> || <span class="keyword">typeof</span> b !== <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a === b;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (map.has(a) || map.has(b)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  map.set(a, b);</span><br><span class="line">  <span class="keyword">const</span> a_keys = <span class="built_in">Object</span>.keys(a);</span><br><span class="line">  <span class="keyword">const</span> b_keys = <span class="built_in">Object</span>.keys(b);</span><br><span class="line">  <span class="keyword">if</span> (a_keys.length !== b_keys.length) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; a_keys.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isEqual(a[a_keys[i]], b[b_keys[i]], map)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="70-implement-Observable-from"><a href="#70-implement-Observable-from" class="headerlink" title="70. implement Observable.from()"></a>70. implement Observable.from()</h3><p>This is a follow-up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>.</p>
<p>Suppose you have solved <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>, here you are asked to implement a creation operator <code>from()</code>.</p>
<p>From the <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/api/index/function/from">document</a>, <code>from()</code></p>
<blockquote>
<p>Creates an Observable from an Array, an array-like object, a Promise, an iterable object, or an Observable-like object.</p>
</blockquote>
<p>Your <code>from()</code> should accept all above types.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).subscribe(<span class="built_in">console</span>.log);</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p><strong>Note</strong></p>
<ol>
<li>Observable is already given for you, no need to create it.</li>
<li>for the problem here, <code>Observable-like</code> means <code>Observable instance</code>. Though in real-world you should check <code>Symbol.observable</code></li>
</ol>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-Subject">71. implement Observable Subject</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array | ArrayLike | Promise | Iterable | Observable&#125;</span> <span class="variable">input</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Observable&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">from</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (input <span class="keyword">instanceof</span> Observable) <span class="keyword">return</span> input;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isIterable = <span class="keyword">typeof</span> input[<span class="built_in">Symbol</span>.iterator] === <span class="string">&#x27;function&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> isArrayLike = input.length !== <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isIterable || isArrayLike) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function">(<span class="params">subscriber</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isArrayLike) input = <span class="built_in">Array</span>.from(input);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> value <span class="keyword">of</span> input) &#123;</span><br><span class="line">          subscriber.next(value);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        subscriber.error(err);</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        subscriber.complete();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (input <span class="keyword">instanceof</span> <span class="built_in">Promise</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function">(<span class="params">subscriber</span>) =&gt;</span> &#123;</span><br><span class="line">      input</span><br><span class="line">        .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">          subscriber.next(result);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">          subscriber.error(err);</span><br><span class="line">        &#125;)</span><br><span class="line">        .finally(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          subscriber.complete();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</span><br><span class="line">    <span class="string">&#x27;You can provide an Observable, Promise, Array, or Iterable.&#x27;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="71-implement-Observable-Subject"><a href="#71-implement-Observable-Subject" class="headerlink" title="71. implement Observable Subject"></a>71. implement Observable Subject</h3><p>This is a follow-up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>.</p>
<p>Plain Observables are unicast, meaning every subscription is independent. To create multicast, you need to use <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/guide/subject">Subject</a>.</p>
<p>Following code is easier to understand.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// default behavior with plain Observable</span></span><br><span class="line"><span class="keyword">const</span> observable = <span class="keyword">from</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">observable.subscribe(<span class="built_in">console</span>.log)</span><br><span class="line">observable.subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>You can see that two subscriptions are independent so the logs are grouped by subscription.</p>
<p>with Subject, it works like Event Listeners in DOM world.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> subject = <span class="keyword">new</span> Subject()</span><br><span class="line">subject.subscribe(<span class="built_in">console</span>.log)</span><br><span class="line">subject.subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> observable = <span class="keyword">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">observable.subscribe(subject)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>Now the logs are different! That is because Subject first works as a observer, get the values, then works as an Observable and dispatch the value to different observers.</p>
<p>Cool right? Ok, you are asked to <strong>implement a simple <code>Subject Class</code></strong>.</p>
<ol>
<li><code>Observable</code> is given for you, you can just use it.</li>
<li>you can use <code>new Observer(&#123;next,error,complete&#125;)</code> or <code>new Observer(function)</code> to create an observer.</li>
</ol>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-from">70. implement Observable.from() </a></p>
<p>每个需要绑定this，然后执行函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// You can use Observer which is bundled to your code</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// class Observer &#123;</span></span><br><span class="line"><span class="comment">//   // subscriber could one next function or a handler object &#123;next, error, complete&#125;</span></span><br><span class="line"><span class="comment">//   constructor(subscriber) &#123; &#125;</span></span><br><span class="line"><span class="comment">//   next(value) &#123; &#125;</span></span><br><span class="line"><span class="comment">//   error(error) &#123; &#125;</span></span><br><span class="line"><span class="comment">//   complete() &#123;&#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.observers = [];</span><br><span class="line">    <span class="built_in">this</span>.next = <span class="built_in">this</span>.next.bind(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.error = <span class="built_in">this</span>.error.bind(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.complete = <span class="built_in">this</span>.complete.bind(<span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">subscribe</span>(<span class="params">subscriber</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> observer = <span class="keyword">new</span> Observer(subscriber);</span><br><span class="line">    <span class="built_in">this</span>.observers.push(observer);</span><br><span class="line">    <span class="keyword">return</span> observer;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">next</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> observer <span class="keyword">of</span> <span class="built_in">this</span>.observers) &#123;</span><br><span class="line">      observer.next(value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">error</span>(<span class="params">error</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> observer <span class="keyword">of</span> <span class="built_in">this</span>.observers) &#123;</span><br><span class="line">      observer.error(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">complete</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> observer <span class="keyword">of</span> <span class="built_in">this</span>.observers) &#123;</span><br><span class="line">      observer.complete();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="72-implement-Observable-interval"><a href="#72-implement-Observable-interval" class="headerlink" title="72. implement Observable interval()"></a>72. implement Observable interval()</h3><p>This is a follow-up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>.</p>
<p>Suppose you have solved <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>, here you are asked to implement a creation operator <code>interval()</code>.</p>
<p>From the <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/api/index/function/interval">document</a>, <code>interval()</code></p>
<blockquote>
<p>Creates an Observable that emits sequential numbers every specified interval of time</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">interval(<span class="number">1000</span>).subscribe(<span class="built_in">console</span>.log);</span><br></pre></td></tr></table></figure>

<p>Above code prints 0, 1, 2 …. with an interval of 1 seconds.</p>
<p><strong>Note</strong> Observable is already given for you, no need to create it.</p>
<p>使用闭包保存数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">period</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Observable&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">interval</span>(<span class="params">period</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">let</span> num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function">(<span class="params">subscriber</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// subscriber.next(num++);</span></span><br><span class="line">      subscriber.next(num);</span><br><span class="line">      num++;</span><br><span class="line">    &#125;, period);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="73-implement-Observable-fromEvent"><a href="#73-implement-Observable-fromEvent" class="headerlink" title="73. implement Observable fromEvent()"></a>73. implement Observable fromEvent()</h3><p>This is a follow-up on <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>.</p>
<p>Suppose you have solved <a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable</a>, here you are asked to implement a creation operator <code>fromEvent()</code>( for DOM Event)</p>
<p>From the <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/api/index/function/fromEvent">document</a>, <code>fromEvent()</code></p>
<blockquote>
<p>Creates an Observable that emits events of a specific type coming from the given event target.</p>
</blockquote>
<p>Simply speaking, it is a util to attach event listener in Observable fashion.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> source = fromEvent(node, <span class="string">&#x27;click&#x27;</span>)</span><br><span class="line">source.subscribe(<span class="function">(<span class="params">e</span>) =&gt;</span> <span class="built_in">console</span>.log(e))</span><br></pre></td></tr></table></figure>

<p>When <code>node</code> is clicked, the event is logged.</p>
<p><strong>Note</strong></p>
<ol>
<li>Observable is already given for you, no need to create it.</li>
<li>the event listener removal is handled by <a target="_blank" rel="noopener" href="https://rxjs-dev.firebaseapp.com/api/index/class/Subscription#add">add()</a>, which is beyond our scope here, you can ignore that.</li>
</ol>
<p>Related Problems</p>
<p><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/create-an-Observable">57. create an Observable </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-from">70. implement Observable.from() </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-Subject">71. implement Observable Subject </a><br><a target="_blank" rel="noopener" href="https://bigfrontend.dev/problem/implement-Observable-interval">72. implement Observable interval() </a></p>
<p>增加新的订阅</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;HTMLElement&#125;</span> <span class="variable">element</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">eventName</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> <span class="variable">capture</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Observable&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fromEvent</span>(<span class="params">element, eventName, capture = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// your code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function">(<span class="params">subscriber</span>) =&gt;</span> &#123;</span><br><span class="line">    element.addEventListener(</span><br><span class="line">      eventName,</span><br><span class="line">      (e) =&gt; &#123;</span><br><span class="line">        subscriber.next(e);</span><br><span class="line">      &#125;,</span><br><span class="line">      capture</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
      
<div>
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
</div>
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag"><i class="fa fa-tag"></i> 前端</a>
              <a href="/tags/bigfrontend/" rel="tag"><i class="fa fa-tag"></i> bigfrontend</a>
              <a href="/tags/%E9%A2%98%E5%BA%93/" rel="tag"><i class="fa fa-tag"></i> 题库</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/06/17/bigfrontend%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E9%A2%98%E7%9B%AE%E8%AE%A8%E8%AE%BA/" rel="prev" title="bigfrontend的输入输出题目讨论">
      <i class="fa fa-chevron-left"></i> bigfrontend的输入输出题目讨论
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/06/25/%E5%85%AB%E8%82%A1%E6%96%87%E7%B3%BB%E5%88%97/" rel="next" title="八股文系列">
      八股文系列 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#js%E5%87%BD%E6%95%B0"><span class="nav-text">js函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-implement-curry"><span class="nav-text">1. implement curry()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-implement-curry-with-placeholder-support"><span class="nav-text">2. implement curry() with placeholder support</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-implement-Array-prototype-flat"><span class="nav-text">3. implement Array.prototype.flat()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-implement-basic-throttle"><span class="nav-text">4. implement basic throttle()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-implement-throttle-with-leading-amp-trailing-option"><span class="nav-text">5. implement throttle() with leading &amp; trailing option</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-implement-basic-debounce"><span class="nav-text">6. implement basic debounce()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-implement-debounce-with-leading-amp-trailing-option"><span class="nav-text">7. implement debounce() with leading &amp; trailing option</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-can-you-shuffle-an-array"><span class="nav-text">8. can you shuffle() an array?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-decode-message"><span class="nav-text">9. decode message</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-first-bad-version"><span class="nav-text">10. first bad version</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-what-is-Composition-create-a-pipe"><span class="nav-text">11. what is Composition? create a pipe()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-implement-Immutability-helper"><span class="nav-text">12. implement Immutability helper</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-push-array-push-all-the-items-in-array-on-the-target"><span class="nav-text">1. &amp;#123;$push: array&amp;#125; push() all the items in array on the target.</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-set-any-replace-the-target"><span class="nav-text">2. {$set: any} replace the target</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-merge-object-merge-object-to-the-location"><span class="nav-text">3. {$merge: object} merge object to the location</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-apply-function-custom-replacer"><span class="nav-text">4. {$apply: function} custom replacer</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-Implement-a-Queue-by-using-Stack"><span class="nav-text">13. Implement a Queue by using Stack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-Implement-a-general-memoization-function-memo"><span class="nav-text">14. Implement a general memoization function - memo()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-implement-a-simple-DOM-wrapper-to-support-method-chaining-like-jQuery"><span class="nav-text">15. implement a simple DOM wrapper to support method chaining like jQuery</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-create-an-Event-Emitter"><span class="nav-text">16. create an Event Emitter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-Create-a-simple-store-for-DOM-element"><span class="nav-text">17. Create a simple store for DOM element</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-Improve-a-function"><span class="nav-text">18. Improve a function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19-find-corresponding-node-in-two-identical-DOM-tree"><span class="nav-text">19. find corresponding node in two identical DOM tree</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-Detect-data-type-in-JavaScript"><span class="nav-text">20. Detect data type in JavaScript</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-implement-JSON-stringify"><span class="nav-text">21. implement JSON.stringify()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-implement-JSON-parse"><span class="nav-text">22. implement JSON.parse()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-create-a-sum"><span class="nav-text">23. create a sum()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#24-create-a-sum"><span class="nav-text">24. create a sum()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-Reorder-array-with-new-indexes"><span class="nav-text">25. Reorder array with new indexes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-implement-Object-assign"><span class="nav-text">26. implement Object.assign()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#27-implement-completeAssign"><span class="nav-text">27. implement completeAssign()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#28-implement-clearAllTimeout"><span class="nav-text">28. implement clearAllTimeout()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#29-implement-async-helper-sequence"><span class="nav-text">29. implement async helper - sequence()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-implement-async-helper-parallel"><span class="nav-text">30. implement async helper - parallel()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-implement-async-helper-race"><span class="nav-text">31. implement async helper - race()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#32-implement-Promise-all"><span class="nav-text">32. implement Promise.all()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-implement-Promise-allSettled"><span class="nav-text">33. implement Promise.allSettled()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#34-implement-Promise-any"><span class="nav-text">34. implement Promise.any()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#35-implement-Promise-race"><span class="nav-text">35. implement Promise.race()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#36-create-a-fake-timer-setTimeout"><span class="nav-text">36. create a fake timer(setTimeout)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#37-implement-Binary-Search-unique"><span class="nav-text">37. implement Binary Search (unique)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#38-implement-jest-spyOn"><span class="nav-text">38. implement jest.spyOn()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#39-implement-range"><span class="nav-text">39. implement range()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#40-implement-Bubble-Sort"><span class="nav-text">40. implement Bubble Sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#41-implement-Merge-Sort"><span class="nav-text">41. implement Merge Sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#42-implement-Insertion-Sort"><span class="nav-text">42. implement Insertion Sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#43-implement-Quick-Sort"><span class="nav-text">43. implement Quick Sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#44-implement-Selection-Sort"><span class="nav-text">44. implement Selection Sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-find-the-K-th-largest-element-in-an-unsorted-array"><span class="nav-text">45. find the K-th largest element in an unsorted array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#46-implement-once"><span class="nav-text">46. implement _.once()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#47-reverse-a-linked-list"><span class="nav-text">47. reverse a linked list</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#48-search-first-index-with-Binary-Search-possible-duplicate-array"><span class="nav-text">48. search first index with Binary Search(possible duplicate array)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#49-search-last-index-with-Binary-Search-possible-duplicate-array"><span class="nav-text">49. search last index with Binary Search(possible duplicate array)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#50-search-element-right-before-target-with-Binary-Search-possible-duplicate-array"><span class="nav-text">50. search element right before target with Binary Search(possible duplicate array)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#51-search-element-right-after-target-with-Binary-Search-possible-duplicate-array"><span class="nav-text">51. search element right after target with Binary Search(possible duplicate array)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#52-create-a-middleware-system"><span class="nav-text">52. create a middleware system</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#53-write-your-own-extends-in-es5"><span class="nav-text">53. write your own extends in es5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#54-flatten-Thunk"><span class="nav-text">54. flatten Thunk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#55-highlight-keywords-in-HTML-string"><span class="nav-text">55. highlight keywords in HTML string</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#56-call-APIs-with-pagination"><span class="nav-text">56. call APIs with pagination</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#57-create-an-Observable"><span class="nav-text">57. create an Observable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#58-get-DOM-tree-height"><span class="nav-text">58. get DOM tree height</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#59-create-a-browser-history"><span class="nav-text">59. create a browser history</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#60-create-your-own-new-operator"><span class="nav-text">60. create your own new operator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#61-create-your-own-Function-prototype-call"><span class="nav-text">61. create your own Function.prototype.call</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#62-implement-BigInt-addition"><span class="nav-text">62. implement BigInt addition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#63-create-cloneDeep"><span class="nav-text">63. create _.cloneDeep()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#64-auto-retry-Promise-on-rejection"><span class="nav-text">64. auto-retry Promise on rejection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#65-add-comma-to-number"><span class="nav-text">65. add comma to number</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#66-remove-duplicates-from-an-array"><span class="nav-text">66. remove duplicates from an array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#67-create-your-own-Promise"><span class="nav-text">67. create your own Promise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#68-get-DOM-tags"><span class="nav-text">68. get DOM tags</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#69-implement-deep-equal-isEqual"><span class="nav-text">69. implement deep equal _.isEqual()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#70-implement-Observable-from"><span class="nav-text">70. implement Observable.from()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#71-implement-Observable-Subject"><span class="nav-text">71. implement Observable Subject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#72-implement-Observable-interval"><span class="nav-text">72. implement Observable interval()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#73-implement-Observable-fromEvent"><span class="nav-text">73. implement Observable fromEvent()</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="hxy"
      src="/images/Robben.gif">
  <p class="site-author-name" itemprop="name">hxy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">104</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/huxingyi1997" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;huxingyi1997" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:huxingyi1997@zju.edu.cn" title="E-Mail → mailto:huxingyi1997@zju.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-frog"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hxy</span>
</div>

<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共894.7k字</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'pQsO3ySbU4VtWN2j1FLA74Ha-gzGzoHsz',
      appKey     : 'QYacMDY2VY7Wazprg1X6FiUv',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

  
  <!-- 动态背景特效 -->
  <!-- 樱花特效 -->
    <script async src="/js/src/sakura.js"></script>
    <script async src="/js/src/fairyDustCursor.js"></script>
</body>
</html>
